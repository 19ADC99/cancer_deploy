[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Multi-omics integration for target discovery in cancer",
    "section": "",
    "text": "Abstract\n[[draft to improve]]\nCancer is a complex heterogeneous disease and challenges the identification of novel therapeutic targets. The complex relationships between DNA, transcripts and proteins captured by different single-omics approaches often fail to capture cancer complexity. Moreover, the non-linear relationships between DNA mutation, transcripts expression and protein abundances challenges the linear regression models often used in target discovery. Multi-omics integration can provide a better understanding of the heterogeneous nature of cancer and provide novel therapeutic targets.\nHere, I leverage public datasets from The Cancer Genome Atlas program, TCGA. I will focus my efforts on Kidney Cancers: kidney chromophobe (KICH), kidney renal papillary cell carcinoma (KIRP), and kidney renal clear cell carcinoma (KIRC).\nFirst, we gonna explore how molecular differences between these three kidney cancers are captured and reflected in different single-omics layers (i.e.: transcriptomics, proteomics), and how linear multi-omics integration strategies deepen the biological insights.\nI will then dig into kidney renal clear cell carcinoma (KIRC) and develop a Deep Learning classifier to discriminate between the different KIRC consensus molecular subtypes. I will compare my method with existing molecular signatures based on transcriptomics data, and test if the new classifier can better classify samples from another cohort and best predict the clinical outcome of the patients.\nFinally, I will try to identify novel therapeutic targets based on my molecular subtypes.",
    "crumbs": [
      "Abstract"
    ]
  },
  {
    "objectID": "gather-datasets-and-QC.html",
    "href": "gather-datasets-and-QC.html",
    "title": "Gather Datasets and QC",
    "section": "",
    "text": "On this page\nBiological insights and take-home messages are at the bottom of the page at Lesson Learnt: Lessons Learnt.",
    "crumbs": [
      "Gather Datasets and QC"
    ]
  },
  {
    "objectID": "gather-datasets-and-QC.html#on-this-page",
    "href": "gather-datasets-and-QC.html#on-this-page",
    "title": "Gather Datasets and QC",
    "section": "",
    "text": "Here we explore the data availability of The Cancer Genome Atlas public resource.\nWe explore the available clinical metadata for each cancer patient.\nWe explore the cohort demographic information.",
    "crumbs": [
      "Gather Datasets and QC"
    ]
  },
  {
    "objectID": "gather-datasets-and-QC.html#gather-resources",
    "href": "gather-datasets-and-QC.html#gather-resources",
    "title": "Gather Datasets and QC",
    "section": "Gather resources",
    "text": "Gather resources\nWe can gather cancer multi-omics datasets from large public data resources such as TCGA (The Cancer Genome Atlas) and the GDC (Genomic Data Commons), as well as smaller-scale datasets generated by individual labs from the USDC Xena platform. From the Xena platform, we can find the data from Pan-Cancer Atlas consortium, which provides textbook high quality datasets that can be explored for target discovery in cancer.\nTCGA PanCan collects 12,839 samples from 28 organs, 69 primary sites spanning 32 different cancer types.\nThe metadata available for the samples and the subjects include:\n\nbiopsys type (metastatic, primary tumor, solid tissue normal) –&gt; data\ncancer subtype based on canonical molecular classification (methylation, miRNA, mRNA, proteins, etc.) –&gt; data\ncancer subtype based on the immune models –&gt; data\noverall survival information –&gt; data\n\nFor these samples, there are available rich clinical metadata and matched multiomics datasets.\nWe can retrieved the following multiomics readouts:\n\ncopy number variants at the gene level –&gt; data\nDNA methylation data –&gt; data\ngene expression (RNAseq) –&gt; data\nmicro RNAs (miRNA) –&gt; data\nprotein expression –&gt; data\nsomatic mutations –&gt; data\n\nAll the multiomics readouts are at the gene level, except for the DNA methylation data, that will have to be mapped and normalized at the gene level. Luckily, a mapping file is available as well.\nXena provides as well already precomputed enrichments and cell types deconvolutions:\n\ngene programs that are canonical drug targets –&gt; data\nhomologous recombination deficiency (HRD) –&gt; data\nimmune signaling –&gt; data\nssGSEA PARADIGM annotations –&gt; data\nstemness score based on DNA methylation signals –&gt; data\nstemnsess score based on the RNAseq expression of 103 key genes –&gt; data\n\nI assure you that integrating all these data will be fun, and it will provide deep insights on each cancer we decided to analyse.",
    "crumbs": [
      "Gather Datasets and QC"
    ]
  },
  {
    "objectID": "gather-datasets-and-QC.html#samples-overview",
    "href": "gather-datasets-and-QC.html#samples-overview",
    "title": "Gather Datasets and QC",
    "section": "Samples Overview",
    "text": "Samples Overview\nNext step is to integrate together all the available sample and subjects metadata. This allows to break down the samples by cancer type and demographic distributions. While Xena provides some information, it lacks a cleaned table containing all the demographic information of the subjects. Conveniently, GitHub user ipezoa already retrieved from GDC and CGC and combined together all the metadata obtained from JSON and XML files. A thorough explanation of each metadata field is reported here.\nLet’s integrate all the metadata together. We have indeed access to a rich and comprehensive ensemble of clinical and sample metadata for the samples at hand.\n\nCohort demographics\nLet’s check the overall demographic distributions of all the samples.\n\n\n\n\n\nFigure 1: Demographic overview.\n\n\n\n\nWe notice that the ration between males and females included in the PanCan dataset is almost 1:1. As well, the age distributions for both sexes are very similar, and the averages of the two distributions almost overlap around 60 years old (59.4 years for female and 60.3 years for males). Race-wise, we have an over-representation of whites (73,4% of samples), followed by 12.0% of samples for which no race information is available. Blacks or african americans and asian represent a small percentage of the samples available, with 8.3% and 6.0% of the samples respectively.\n\n\nClinical overview\nLet’s check now the different cancer included in the study.\n\n\n\n\n\nFigure 2: Clinical overview.\n\n\n\n\nWe can check for any biases in terms of sex and ethnicity in the collected cancer samples. I would not expect any surprise here. Let’s see.\n\n\n\n\n\nFigure 3: Clinical metadata breakdown by sex and ethnicity.\n\n\n\n\nLastly, we can test how much … discrimination power gene expression filter lowly expressed genes selecte the top 1000 most variable genes By selecting the top 1,000 most variable genes we can see that there are clear differences between each cancer type, as captured by the UMAP.\n\n\n\n\n\nFigure 4: UMAP RNAseq.\n\n\n\n\nThe UMAP show us that we can clearly clusters cancer types in distinct groups, and that we can identify clusters with related cancers (i.e.: colon-adenocarcinoma COAD and rectum-adenocarcinoma READ).",
    "crumbs": [
      "Gather Datasets and QC"
    ]
  },
  {
    "objectID": "gather-datasets-and-QC.html#sec-lesson-learnt-gather-datasets-and-QC",
    "href": "gather-datasets-and-QC.html#sec-lesson-learnt-gather-datasets-and-QC",
    "title": "Gather Datasets and QC",
    "section": "Lessons Learnt",
    "text": "Lessons Learnt\nSo far, we have learnt:\n\nTCGA is a public resource with a wide collection of samples from cancer biopsies from patients affected by 32 different cancer types.\nTCGA provides abundant molecular and clinical information for both biopsies and patients and it allows for patient stratification and therapeutic target discovery.\nCancers with kidneys as primary sites are the third most abundant samples available in TCGA (n = 1,030 samples), after breast (n = 1,246) and lung biopsies (n = 1,156), and provides an excellent yet challenging case-study.",
    "crumbs": [
      "Gather Datasets and QC"
    ]
  },
  {
    "objectID": "gather-datasets-and-QC.html#session-information",
    "href": "gather-datasets-and-QC.html#session-information",
    "title": "Gather Datasets and QC",
    "section": "Session Information",
    "text": "Session Information\n\n\n\n\n\n\nNote\n\n\n\n\n\n\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-conda-linux-gnu (64-bit)\nRunning under: openSUSE Tumbleweed\n\nMatrix products: default\nBLAS/LAPACK: /home/andrea/miniforge3/envs/moai/lib/libmkl_rt.so.2;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=it_IT.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Brussels\ntzcode source: system (glibc)\n\nattached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] umap_0.2.10.0      stringr_1.5.1      scales_1.3.0       RColorBrewer_1.1-3\n [5] matrixStats_1.5.0  gridExtra_2.3      ggplot2_3.5.1      forcats_1.0.0     \n [9] edgeR_4.0.16       limma_3.58.1       DT_0.33            dplyr_1.1.4       \n[13] data.table_1.16.4  cowplot_1.1.3     \n\nloaded via a namespace (and not attached):\n [1] sass_0.4.9        generics_0.1.3    stringi_1.8.4     lattice_0.22-6   \n [5] digest_0.6.37     magrittr_2.0.3    evaluate_1.0.3    fastmap_1.2.0    \n [9] jsonlite_1.8.9    Matrix_1.6-5      RSpectra_0.16-2   crosstalk_1.2.1  \n[13] jquerylib_0.1.4   cli_3.6.3         rlang_1.1.5       munsell_0.5.1    \n[17] cachem_1.1.0      withr_3.0.2       yaml_2.3.10       tools_4.3.2      \n[21] colorspace_2.1-1  locfit_1.5-9.10   reticulate_1.40.0 vctrs_0.6.5      \n[25] R6_2.5.1          png_0.1-8         lifecycle_1.0.4   htmlwidgets_1.6.4\n[29] pkgconfig_2.0.3   pillar_1.10.1     bslib_0.8.0       gtable_0.3.6     \n[33] glue_1.8.0        Rcpp_1.0.14       statmod_1.5.0     xfun_0.50        \n[37] tibble_3.2.1      tidyselect_1.2.1  knitr_1.49        farver_2.1.2     \n[41] htmltools_0.5.8.1 labeling_0.4.3    rmarkdown_2.29    compiler_4.3.2   \n[45] askpass_1.2.1     openssl_2.3.1",
    "crumbs": [
      "Gather Datasets and QC"
    ]
  },
  {
    "objectID": "dataset-exploration.html",
    "href": "dataset-exploration.html",
    "title": "1  Data Exploration - Kidney Cancer",
    "section": "",
    "text": "1.1 On this page\nBiological insights and take-home messages are at the bottom of the page at Lesson Learnt: Section 1.4.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Data Exploration - Kidney Cancer</span>"
    ]
  },
  {
    "objectID": "dataset-exploration.html#on-this-page",
    "href": "dataset-exploration.html#on-this-page",
    "title": "1  Data Exploration - Kidney Cancer",
    "section": "",
    "text": "Here we focus on samples from Kidney Cancers patients and their overall relationships.\nWe then explore the association between each Kidney Cancer subtype and the major clinical covariates (e.g.: sex, disease status, cancer stage, clinical outcome).",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Data Exploration - Kidney Cancer</span>"
    ]
  },
  {
    "objectID": "dataset-exploration.html#selection-of-kidney-samples",
    "href": "dataset-exploration.html#selection-of-kidney-samples",
    "title": "1  Data Exploration - Kidney Cancer",
    "section": "1.2 Selection of Kidney samples",
    "text": "1.2 Selection of Kidney samples\nFor the next sections, we will focus on kidney cancer. The choice is simply dictated by the abundance of samples which provide us a large playground to test different strategies for biomarker discovery, higher statistical power, and the existance of some Molecular Subtypes gene signatures that we can use as a benchmark and we can try to improve upon.\nLet’s select and explore the samples available for Kidney tissue.\n\n1.2.1 General Overview of the Dataset\nTo have a first overview of all the Kidney samples, we will plot a UMAP based on the gene expression of all the biopsys. A UMAP is an algorithm for dimension reduction based on manifold learning techniques and ideas from topological data analysis. The UMAP algorithm first constructs a weighted graph of the data in input (with N-dimensions), where the weight in the graph edge corresponds to how similar is a point (i.e.: sample) to the next one, and then projects this similarity graph into a bi-dimensional space. The 2-D projection is optimized to faithfully represents the relationships between the points in the N-dimensional space.\nTo build the UMAP, we focus on the 1,000 top most variable genes between the transcriptomics samples. This allows us to maximize similarities and differences between sample groups (if any).\nThe UMAP of all the samples divides the biopsys into 4 major clusters. Three clusters are localized on the upper part of the UMAP, and they loosely correspond to the three cancer subtypes in this cohort: kidney chromophobe (KICH), kidney renal papillary cell carcinoma (KIRP), and kidney renal clear cell carcinoma (KIRC). A further separation of the samples is visible on the y axis: biopsys from primary tumor are localized on top of the UMAP, while a second cluster of normal solid tissue are localized in the bottom of the UMAP, containing samples from non-diseased tissues of patients of all of the three cancer types.\n\n\n\n\n\nFigure 1: Kidney UMAP - unfiltered data.\n\n\n\n\nSince we want to focus on discovering new biomarkers for the three kidney cancer types, we will remove the biopsys from normal solid tissue. Then, we test if there is a strong imbalance between the sex and age of the subjects in the three kidney cancer cohorts, and wheter we should balance the cohorts or not.\n\n\n1.2.2 Cohort filtering\nFirst, we retain only biopsys from “Primary Tumor”, removing “Solid Tissue Normal” and “Additional - New Primary” neoplasis. Then we look at the distribution of age, sex and ethnicity in the three different cancer cohorts.\n\n\n\n\n\nFigure 2: Kidney Cancer: demographic overview.\n\n\n\n\nWe can immediatly see that the sampling biase towards patients with white background observed in all the cancer cohorts in Section 3.1 is reflected as well in kidney cancer cohorts. In terms of geneder demographics, males represents from 60% (KICH) to 74% (KIRP) of the cohorts. The histograms split by cancer types, however, show that the age distributions between the sexs int he different kidney cancer types are similar.\nSince we may loose too many samples if we would generate balanced cohorts in terms of sex and race, we can keep the samples as is, and take Age, Sex and Race in account during the modeling phases downstream.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Data Exploration - Kidney Cancer</span>"
    ]
  },
  {
    "objectID": "dataset-exploration.html#contingency-tables",
    "href": "dataset-exploration.html#contingency-tables",
    "title": "1  Data Exploration - Kidney Cancer",
    "section": "1.3 Contingency tables",
    "text": "1.3 Contingency tables\nAs we saw previously TCGA provides rich clinical metadata for each patient. We can run some simple demographic statistics (chi-squared and Fisher exact tests) to see if any clinical covariate is significantly overrepresented in any of the three cancer types.\nWe can test if there is a significant difference of each observed clinical covariate across the three kidney cancer types. The null hypothesis here is that the distribution of each covariate in the the three cancer subtypes is the same.\n\n1.3.1 Sex\nThere are 596 males and 291 females in the three kidney cancer cohorts after filtering. Despite the imbalance, the difference across cancer types is not significant.\n\n\n\n\n\n\n\n\n\n\n\nFigure 3: Contigency table, Sex.\n\n\n\n\n\n\n1.3.2 Disease status\nAfter filtering, the three kidney cancer types contains 563 subject that are now tumor free, and 190 subject that still have tumor. It seems that KIRP have significantly more patients that are now tumor free, while there are still significantly more patients with tumor for KIRC. The small sample size of KICH patients may skew these results, so this outcome should be interpreted with a pinch of salt.\n\n\n\n\n\n\n\n\n\n\n\nFigure 4: Contigency table, Disease Status.\n\n\n\n\n\n\n1.3.3 Tumor Stages\nThe tumors across the patients were scored as: 458 Stage I, 105 Stage II, 189 Stage III and 105 Stage IV tumors.\nThis staging system is less granular than the TNM Staging System (that we look at into below), and it describe the tumro as follow:\n\nStage 0 = Abnormal cells are present but have not spread to nearby tissue. Also called carcinoma in situ, or CIS. CIS is not cancer, but it may become cancer.\nStage I, Stage II, and Stage III = Cancer is present. The higher the number, the larger the cancer tumor and the more it has spread into nearby tissues.\nStage IV = The cancer has spread to distant parts of the body.\n\nThe higher the number, the more advanced the cancer is.\nKIRC patients seem to have a higher number of Stage IV cancer, while KIRP patients have more STage I cancers. This can either be bias in the sampling of the cohort, or it could really indicate that KIRC cancer is more aggressive and fast progressing than KIRP.\n\n\n\n\n\n\n\n\n\n\n\nFigure 5: Contigency table, Tumor Stage.\n\n\n\n\n\n\n1.3.4 Tumor Histology\nHistological evaluation of the tumor cells essential to allow for accurate prognostication and tailored therapy, both surgical and adjuvant.\nHistological grade have five categories:\n\nG1 = Well differentiated\nG2 = Moderately differentiated\nG3 = Poorly differentiated, Undifferentiated, Anaplastic\nG4 = Undifferentiated (high grade)\nGX = Grade cannot be assessed\n\nUnfortunately, within the TCGA kidney cohorts, only KIRC biopsys where graded histologically. No histological grading was available for KICH and KIRP tumors.\nFor the KIRC tumors, 14 biopsys had G1 grade, 229 G2 grade, 204 had G3 grade, 76 G4 and 5 biopsys could not be graded (GX).\n\n\n\n\n\n\n\n\n\n\n\nFigure 6: Contigency table, Tumor Histology.\n\n\n\n\n\n\n1.3.5 TMN, T: Main Tumor Pathology\nLet’s look now into the TMN staging system. We have multiple staging and substaging that describes the tumor presence, dimension and invasion of adjacent tissues:\n\nTX = Primary tumor cannot be assessed.\nT0 = No evidence of primary tumor.\nT1 = Tumor ≤2 cm in greatest dimension.\nT2 = Tumor &gt;2 cm but ≤4 cm.\nT3 = Tumor &gt;4 cm or with subserosal invasion or involvement of the mesoappendix.\nT4 = Tumor perforates the peritoneum or directly invades other adjacent organs or structures (excluding direct mural extension to adjacent subserosa of adjacent bowel), e.g., abdominal wall and skeletal muscle.\n\nThe presence of 12 distinct substaging for TMN, and the relative small sample size across the cohort makes the outcome of this comparison difficult to judge. We could claim that KIRP seems to be enriched in lower tumor stages (T1a) and depleted in higher tumor stages (T2, T3a, T3b) than KIRC.\n\n\n\n\n\n\n\n\n\n\n\nFigure 7: Contigency table, TMN Main Tumor.\n\n\n\n\n\n\n1.3.6 TMN, N: Lymph Nodes metastatis\nThe TMN tumor staging system provides as well a score for the lymph nodes:\n\nNX = Regional lymph nodes cannot be assessed.\nN0 = No regional lymph node metastasis.\nN1 = Regional lymph node metastasis &lt;12 nodes.\nN2 = Large mesenteric masses (&gt;2 cm) and/or extensive nodal deposits (≥12), especially those that encase the superior mesenteric vessels.\n\nIn the kidney cohort, lymph nodes of 506 patiens could not be scored (NX), 328 patients had a N0 score, 43 N1 and 7 had a N2 score. Lymph nodes of most patients with KIRP tumors could not be scored, they they were depleted in No and enriched in N1 if compared with patients with KIRC tumor.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8: Contigency table, TMN Lymph nodes.\n\n\n\n\n\n\n1.3.7 Prognosis Outcome\nOf the 887 petients with kidney tumor, 659 were alive at the time of the last check up, while 228 died. It appears that KIRC patients (48.7% dead) have worse prognosis than KIRP patients (17.9% dead), as observed in the previous comparisons. However, before drawing a formal conclusion, we should validate this observation at least in another independent cohort.\n\n\n\n\n\n\n\n\n\n\n\nFigure 9: Contigency table, Vital Status.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Data Exploration - Kidney Cancer</span>"
    ]
  },
  {
    "objectID": "dataset-exploration.html#sec-lesson-learnt-dataset-exploration",
    "href": "dataset-exploration.html#sec-lesson-learnt-dataset-exploration",
    "title": "1  Data Exploration - Kidney Cancer",
    "section": "1.4 Lessons Learnt",
    "text": "1.4 Lessons Learnt\nSo far, we have learnt:\n\nA UMAP is a handy way to summarize relationship between data:\n\nProjecting the transcriptomics data from kidney cancer biopsies with a UMAP showed that samples are grouped in three clusters, loosely corresponding to the three kidney cancer types (KICH, KIRC, KIRP).\nSome samples seem to be misclassified and clustered in the wrong cancer type group, or there are additional nuances that were not classified with bulk RNA-seq.\n\nContingency tables reports on large clinical trends between the three cancer types:\n\nKIRC patients seems to have a higher chance to be tumor free than KIRP patients.\nDespite that, KIRC patients seems to be enriched for Stage IV tumors and depleted in Stage I tumors when compared to KIRP patients.\nLikewise, KIRP patients have more T1a tumor stages and less T2, T3a and T3b tumours when compared to KIRC.\nUnfortunately, KIRC patients seems to had a worse outcome than KIRP patients.\n\nThe clinical outcome for KIRC patients seems to be more polarized: or the patient were cancer free at the end of the study, or the patient had more advanced tumour or a worse outcome when compared to KIRP patients. This overview suggest the possibility that if we could develop biomarkers for early detection of KIRC cancers we could improve the clinical outcome for these patients.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Data Exploration - Kidney Cancer</span>"
    ]
  },
  {
    "objectID": "dataset-exploration.html#session-information",
    "href": "dataset-exploration.html#session-information",
    "title": "1  Data Exploration - Kidney Cancer",
    "section": "1.5 Session Information",
    "text": "1.5 Session Information\n\n\n\n\n\n\nNote\n\n\n\n\n\n\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-conda-linux-gnu (64-bit)\nRunning under: openSUSE Tumbleweed\n\nMatrix products: default\nBLAS/LAPACK: /home/andrea/miniforge3/envs/moai/lib/libmkl_rt.so.2;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=it_IT.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Brussels\ntzcode source: system (glibc)\n\nattached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] vcd_1.4-13         umap_0.2.10.0      stringr_1.5.1      scales_1.3.0      \n [5] RColorBrewer_1.1-3 matrixStats_1.5.0  gridExtra_2.3      ggplot2_3.5.1     \n [9] forcats_1.0.0      edgeR_4.0.16       limma_3.58.1       DT_0.33           \n[13] dplyr_1.1.4        data.table_1.16.4  cowplot_1.1.3     \n\nloaded via a namespace (and not attached):\n [1] sass_0.4.9          tidyr_1.3.1         generics_0.1.3     \n [4] stringi_1.8.4       lattice_0.22-6      digest_0.6.37      \n [7] magrittr_2.0.3      evaluate_1.0.3      fastmap_1.2.0      \n[10] jsonlite_1.8.9      Matrix_1.6-5        RSpectra_0.16-2    \n[13] purrr_1.0.2         crosstalk_1.2.1     jquerylib_0.1.4    \n[16] cli_3.6.3           rlang_1.1.5         munsell_0.5.1      \n[19] cachem_1.1.0        withr_3.0.2         yaml_2.3.10        \n[22] tools_4.3.2         colorspace_2.1-1    locfit_1.5-9.10    \n[25] BiocGenerics_0.48.1 reticulate_1.40.0   vctrs_0.6.5        \n[28] R6_2.5.1            png_0.1-8           zoo_1.8-12         \n[31] lifecycle_1.0.4     htmlwidgets_1.6.4   MASS_7.3-60.0.1    \n[34] pkgconfig_2.0.3     bslib_0.8.0         pillar_1.10.1      \n[37] gtable_0.3.6        glue_1.8.0          Rcpp_1.0.14        \n[40] statmod_1.5.0       xfun_0.50           tibble_3.2.1       \n[43] lmtest_0.9-40       tidyselect_1.2.1    knitr_1.49         \n[46] farver_2.1.2        htmltools_0.5.8.1   labeling_0.4.3     \n[49] rmarkdown_2.29      compiler_4.3.2      askpass_1.2.1      \n[52] openssl_2.3.1",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Data Exploration - Kidney Cancer</span>"
    ]
  },
  {
    "objectID": "transcriptomics-analysis.html",
    "href": "transcriptomics-analysis.html",
    "title": "2  Transcriptomics Analysis",
    "section": "",
    "text": "2.1 On this page\nBiological insights and take-home messages are at the bottom of the page at Lesson Learnt: Section 2.6.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transcriptomics Analysis</span>"
    ]
  },
  {
    "objectID": "transcriptomics-analysis.html#on-this-page",
    "href": "transcriptomics-analysis.html#on-this-page",
    "title": "2  Transcriptomics Analysis",
    "section": "",
    "text": "Here we investigate the transcriptomics data across the three Kidney Cancers.\nFirst we filter lowly expressed genes and we do some exploratory analyses on samples, gene expression and clinical covariates.\nWe then run a formal Differential Gene Expression analysis to identify genes that have different expression levels across the three Kidney cancer types.\nWe perform Gene Set Enrichment Analyses on the differentially expressed genes to investigate biological and molecular themes that discriminates between the three Kidney cancer types.\nFinally, we characterize the tumour micro-environments of the three Kidney cancer types by quantifying the tumour-infiltrating immune cells.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transcriptomics Analysis</span>"
    ]
  },
  {
    "objectID": "transcriptomics-analysis.html#filtering-of-lowly-abundant-genes",
    "href": "transcriptomics-analysis.html#filtering-of-lowly-abundant-genes",
    "title": "2  Transcriptomics Analysis",
    "section": "2.2 Filtering of lowly abundant genes",
    "text": "2.2 Filtering of lowly abundant genes\nThe first step for transcriptomics analysis is to filter genes that are lowly expressed across all samples because they just inflate the data matrix and they do not contribute to the detection of the biological signal.\nThe filtering step results in the removal of 6,472 genes. The graph below reports the density curves of gene expressions (logCPM) before and after filtering of lowly expressed genes. Each line represent a sample. Before filtering, all samples showed a left-hand side shoulder, with a peak below 0 logCPM higher than a second peak centered around 5 logCPM. The peak below 0 logCPM represent all the lowly to non-expressed genes. After filtering, only expressed genes are retained.\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transcriptomics Analysis</span>"
    ]
  },
  {
    "objectID": "transcriptomics-analysis.html#dimesionality-reduction-and-dataset-exploration",
    "href": "transcriptomics-analysis.html#dimesionality-reduction-and-dataset-exploration",
    "title": "2  Transcriptomics Analysis",
    "section": "2.3 Dimesionality Reduction and Dataset Exploration",
    "text": "2.3 Dimesionality Reduction and Dataset Exploration\n\n2.3.1 UMAP on filtered transcriptomics data\nAfter we excluded biopsys from normal tissues and other tumors and we filtered out the lowly expressed genes, the UMAP shows three clusters that are better refined than the ones depicted in Section 1.2.1, and that roughly correspondes with three different kidney cancer subtypes.\n\n\n\n\n\nFigure 2: Kidney UMAP.\n\n\n\n\n\n\n2.3.2 Principal Component Analysis (PCA)\nThe Principal Component Analysis (PCA) is an unsupervised linear dimensionality reduction technique that summarizes large amount of information (as the one in a transcriptomics count table) into a smaller set of summarized variables (Principal Components) that capture the linear relationships between the data. In a transcriptomics dataset, the number of Principal Components equals the number of samples.\nThe PCA algorithm is run in an iterative manner: the first Principal Component is calculated by finding the line that maximizes the variance between the samples. The second Principal Component is calculated in the same way, with the condition that it is uncorrelated with (i.e., perpendicular to) the first principal component and that it accounts for the next highest variance. The third Principal Component is calculated in the same way, down to the last Principal Component.\nTo run PCA analyses on transcriptomics data, I recommend the PCAtools package by Kevin Blighe and Aaron Lun.\n\n\n\n\n\nFigure 3: PCA, exploration.\n\n\n\n\nThe first 24 Principal Components capture more than 80% of the variance in the Kidney cancers transcriptomics dataset, with the first two components (PC1 and PC2) capturing a bit more than 25% of the variance.\nWhen we project the samples in the PC1 and PC2, we can see that the PC1 separates KIRC from KICH adn KIRP, which instead cluster together. The second component PC2, instead, seems to partially separate KICH and KIRP samples.\n\n\n\n\n\nFigure 4: PCA, biplot PC1 x PC2.\n\n\n\n\nWe can also investigate other dimensions Principal Components, to see if there is a component that manages to fully resove the three cancer types. PC4 seems to separates better the KICH from KIRP, while PC1 can discriminate between KIRC and KIRP.\n\n\n\n\n\nFigure 5: PCA, pairs plots.\n\n\n\n\nLet’s check the loadings (i.e.: 24 Principal Components capture more than 80% of the variance in the) for the top 4 Principal Components. These indicate which genes are the more responsible to explain the position of the samples along the components, and the direction of this separation.\nLooking at the top 1% most variable genes (~ 140 genes), the following 5 genes are the top loadings for the first 4 Principal Components:\n\nSPP1\nVIM\nFTL\nRGS5\nLOC96610\n\nLet’s now check the expression of the five top genes identified with the PCA across the cancer types:\n\n\n\n\n\nFigure 6: PCA, loadings.\n\n\n\n\nLet’s check the Pearson correlation with other clinical covariates.\nCertain histological and molecular subtyping correlates perfectly with PC4 (which discriminates KICH) immune infiltrating cells also correlates with PC1 and PC2, and may help to further characterize the subtypes and stratify patients\nAs we have learnt before (Section 1.3.7), KIRC patients seems to had a worse outcome than KIRP and to have tumors in more advanced stages. PC1 (computed from transcriptomics data) clearly separates KIRC and KIRP samples, and it correlates with tumor histological grade and stage, as well as clinical outcome. This show that we have good correlation between clinical observations and gene expression in Kidney cancers.\nSadly, no correlation between the top 5 components and the outcome of therapeutic care.\n\n\n\n\n\nFigure 7: PCA, correlations between clinical covariates and Principal Components.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transcriptomics Analysis</span>"
    ]
  },
  {
    "objectID": "transcriptomics-analysis.html#differential-gene-expression-analysis",
    "href": "transcriptomics-analysis.html#differential-gene-expression-analysis",
    "title": "2  Transcriptomics Analysis",
    "section": "2.4 Differential gene expression analysis",
    "text": "2.4 Differential gene expression analysis\nDifferential gene expression (DGE) analysis is used compare gene expression levels between two or more sample groups, in this case, Kidney cancer types. DGE can help in identifying genes involved in a particular biological process, providing information on gene regulation and underlying biological mechanisms. One of the most used approaches to identify associations between genes and biological consist in applying generalized linear models, which aims to assign the variation in gene expression to each known variable in the experimental design, such as patient age, ethnicity, cancer type, treatment center taking care of the patients, etc.\nIn the section above we saw that age, ethnicity (and race) and age had somewhat a correlation with the cancer types. Therefore, we include this covariates in the differential gene expression analysis in order to take their contribution to gene expression variance into account.\nNow, we will compare the gene expression across the three different Kidney cancer types, and we will test the following pairwise comparisons for genes that are differentially expressed: KICH vs KIRC, KICH vs KIRP and KIRC vs KIRP.\n\n2.4.1 Identification of differentially expressed genes\nFor transcriptomics analyses, we use two arbitrary thresholds to retain genes that are significantly differentially expressed across the each comparison: an absolute logFold-Change (logFC) higher than 2, and an adjusted p-value lower than 0.05. This results in:\n\nKIRC_vs_KICH, 2,058 differentially expressed genes, 1,553 upregulated and 505 downregulated\nKIRP_vs_KICH, 1,567 differentially expressed genes, 1,101 upregulated and 466 downregulated\nKIRC_vs_KIRP, 739 differentially expressed genes, 570 upregulated and 169 downregulated\n\nThe relationships between how much a gene is differentially expressed (logFC) and its likelihood to be observed (p-value) in a DGE comparison is often visualized with a volcano plot, where each dot represent a gene. There are hundreds of genes that are differentially expressed across the biopsies of the three different kidney cancers in our cohorts.\n\n\n\n\n\nFigure 8: Volcano plots of each contrats reporting the genes differentially expressed.\n\n\n\n\nWe can also check the logFC and adjusted p-value for the top 5 genes that are the top loadings for the first 4 Principal Components and see how these genes were differentially expressed across the comparisons. We can confirm what we have naively observed at the level of gene counts in Figure 6 while investigating the PCA loadings: while these 5 genes have been suggested has the top loadings of the 2 Principal Components, FTL seems to do not have a large difference in expression across the three Kidney tumours.\n\n\n\n\n\n\nWe can further dig into the hundreds of genes that are differentially expressed by looking at the overlaps between the upregulated and downregulated genes across the three DGE comparisons. The UpSet plot below facilitates visualizing these overlaps. As seen in the PCA, PC1 explain ~15% of the variability observed in the genes, and it separates KIRC from KICH and KIRP kidney cancer. We would then expect a large overlap between KIRC_vs_KIRP and KIRC_vs_KICH DE genes, however, we see instead that the largest overlaps between DE genes are between KIRC_vs_KICH and KIRP_vs_KICH comparisons. This suggest that KIRC and KIRP are more similar to each other than KICH, suggesting a more complex relationship than the one observed in the first two principal components.\n\n\n\n\n\nFigure 9: UpSet reporting the genes differentially expressed upregulated and downregulated in common across all contrasts.\n\n\n\n\nTables of differentially expressed genes.\n\nKIRC vs KICHKIRP vs KICHKIRC vs KIRP\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2.4.2 Comparative enrichment analyses across cancer types\nIn the next steps we further characterized the hundreds of genes that are differentially expressed across the three kidney cancers by performing a Gene Set Enrichment Analysis (GSEA). GSEA can identify whether specific pathways or molecular functions are upregulated or downregulated across the entire list of genes, providing insight into the biological differences at the gene expression levels between the three kidney cancers.\nWe will perform GSEA against an annotated set of gene ontologies and pathways:\n\nGene Ontology (GO). Gene Ontology provides a a comprehensive, computational model of biological systems and it is the world’s largest source of information on the functions of genes. It provides terms organized in three hierarchical ontologies (BP, CC and MF), that provide insights over gene Biological Processes (BP), Cellular Compartments (CC) and Molecular Functions (MF).\nKyoto Encyclopedia of Genes and Genomes pathways (KEGG). KEGG is a database resource for understanding high-level functions and utilities of the biological system, such as the cell, the organism and the ecosystem, from molecular-level information. KEGG pathway is a collection of manually drawn pathway maps representing our knowledge of the molecular interaction, reaction and relation networks.\nReactome Pathways. Reactome is a free, open-source, curated and peer-reviewed pathway database.\nWikiPathways. WikiPathways is an open science platform for biological pathways contributed, updated, and used by the research community.\n\n\n2.4.2.1 GO Biological Process terms\nGene Ontology Biological Process are the larger processes or ‘biological programs’ accomplished by the concerted action of multiple molecular activities. Examples of broad BP terms are “DNA repair” or “signal transduction”. Examples of more specific terms are “cytosine biosynthetic process” or “D-glucose transmembrane transport”.\n\ndotplotterms mapgene mapGO terms clusters\n\n\n\n\n\n\n\nFigure 10: dotplot of enriched GO Biological Process terms.\n\n\n\n\n\n\n\n\n\n\n\nFigure 11: Term maps reporting relationships between GO Biological Process across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 12: gene maps reporting relationships between GO Biological Process enriched across the different contrasts\n\n\n\n\n\n\n\n\n\n\n\nFigure 13: GO cluster heatmaps.\n\n\n\n\n\n\n\nGiven the hundreds of genes in each contrast, hundreds of enriched GO BP terms have been identified across the three kidney cancer comparisons: 1,715 in KIRC_vs_KICH, 1,266 in KIRP_vs_KICH and 637 in KIRC_vs_KIRP. The dotplot reports on the most important term for each contrast, and based on this high-level overview we cannot really spot large differences across the three comparisons except for “regulation of T cell activation” that seems to be present only in KIRC_vs_KICH and not in the other contrasts.\nThe terms map provides an overview of the relationships between the most significant GO terms, and in which contrasts they appear. Each term is a colored circle, and each connection is a relationship of hierarchy between two terms. Each circle (term) is colored based on the contrast where it appears. Here, we can get a bit more insights in the differences between the three kidney cancers, but there is still an overwhelming abundance of information.\nA cluster of terms related to immune response, lymphocyte activation, differentiation and recruitment is clearly visible in the KIRC_vs_KICH and KIRP_vs_KICH comparisons, while it is absent in the contrast KIRC_vs_KIRP.\nThe gene map helps to further refine the genes annotated with the most significant GO terms. Genes are connected to the corresponding GO term, and coloured according to the contrasts that they belong to.\nInterpretation of the large amount of GO BP terms identified is difficult, given as well their similarity across the three contrasts. An option to increase interpretability is to cluster the GO terms based on their hierarchy and similarity. An elegant way to do so is to compute a distance matrix of the GO terms, and then perform a binary cut to identify GO terms clusters.\nThe rich GO cluster heatmap confirms that immune response and leucocyte activation terms are enriched in the KIRC_vs_KICH contrast when compared to KIRP_vs_KICH and KIRC_vs_KIRP. Also angiogenesis and development terms are clustered in two blocks that sees KIRC_vs_KICH in one side and KIRP_vs_KICH and KIRC_vs_KIRP on the other one. Ion transport and metabolic processes are more similar between KIRC_vs_KICH and KIRP_vs_KICH, and this could be a set of biological processes that are similarly disregulated in KIRC and KIRP.\nThe complete list of 2,632 GO BP terms enriched across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n2.4.2.2 GO Cellular Compartments terms\nGene Ontology Cellular Compartment serves to capture the cellular location where a molecular function takes place.\n\ndotplotterms mapgene mapGO terms clusters\n\n\n\n\n\n\n\nFigure 14: dotplot of enriched GO Cellular Compartments terms.\n\n\n\n\n\n\n\n\n\n\n\nFigure 15: Term maps reporting relationships between GO Cellular Compartments across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 16: gene maps reporting relationships between GO Cellular Compartments enriched across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 17: gene maps reporting relationships between GO Cellular Compartments enriched across the different contrasts.\n\n\n\n\n\n\n\nThe terms dotplot and indicates that the enriched GO CC terms revolves around “plasma membrane”, “collagen” and the “extra-cellular matrix”, suggesting that most genes that are differentially expressed may be involved in transport across the plasma membrane and the remodeling of the extra-cellular matrix.\nThe terms map confirm this message, and in addition we have terms associated with “endocytic vesicles” and “MHC protein complexes” in KIRC_vs_KICH contrast, supporting the idea of a stronger T cell activation in KIRC.\nThe rich GO cluster heatmap shows that after clustering, most terms associated with plasma membrane and extra-cellular matrix remodeling are more abundant in KIRC_vs_KICH and KIRP_vs_KIRP, suggesting that extra-cellular matrix remodeling is more enhanced in KIRC, and may support a more Epithelial-Mesenchimal Transition (ETM) phenotype of this cancer.\nThe complete list of 218 GO CC terms enriched across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n2.4.2.3 GO Molecular Function terms\nGene Ontology Molecular Function serves to represent molecular-level activities performed by gene products.\n\ndotplotterms mapgene mapGO terms clusters\n\n\n\n\n\n\n\nFigure 18: dotplot of enriched GO Molecular Functions terms.\n\n\n\n\n\n\n\n\n\n\n\nFigure 19: Term maps reporting relationships between GO Molecular Functions across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 20: gene maps reporting relationships between GO Molecular Functions enriched across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 21: gene maps reporting relationships between GO Molecular Functions enriched across the different contrasts.\n\n\n\n\n\n\n\nThe GO MF terms map and terms cluster suggest clear differences that discriminates KIRC and KICH tumors. KIRC and KIRP seem to have enriched terms on metabolism and strong transporter activities (i.e.: “solute:monoatomic cation symporter activity”, “solute:sodium symporter activity”) when compared to KICH, suggesting that these two kidney cancers are metabolically more active. KIRC instead have enriched GO MF terms associated with remodelling of the extracellular matrix (e.g.: “extracellular matrix structural constituent”, “collagen binding”), receptor activity and chemokine binding (e.g.: “G protein-coupled receptor binding”, “cytokine binding”), suggesting a more hot type of tumor with active recruitment and infiltration of immune cells, when compared to KIRP and KICH.\nThe complete list of 316 GO MF terms enriched across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n2.4.2.4 KEGG pathways\nKEGG pathways are manually curated and capture our knowledge of the molecular interaction, reaction and relation networks.\n\ndotplotterms mapgene map\n\n\n\n\n\n\n\nFigure 22: dotplot of enriched KEGG pathways.\n\n\n\n\n\n\n\n\n\n\n\nFigure 23: Term maps reporting relationships between KEGG pathways enriched across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 24: gene maps reporting relationships between KEGG pathways enriched across the different contrasts.\n\n\n\n\n\n\n\nThe signal captured in the enriched KEGG pathways seems less clear than the one identified across the enriched GO terms, but in general, the terms maps provide a story in line to what described with the enriched GO terms. KIRC present a stronger immune response when compared to KIRP and KICH (i.e.: “Th1 and Th2 cell differentiation”, “Th17 cell differentiation”, “Hematopoietic cell lineage”) and extracellular matrix remodelling / epithelial-to-mesenchimal transition (e.g.: “Rap1 signaling pathway”).\nThe complete list of 95 KEGG pathways across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n2.4.2.5 Reactome pathways\nSimilarly to KEGG, Reactome pathways are manually curated biological pathways.\n\ndotplotterms mapgene map\n\n\n\n\n\n\n\nFigure 25: dotplot of enriched Reactome pathways.\n\n\n\n\n\n\n\n\n\n\n\nFigure 26: Term maps reporting relationships between Reactome pathways enriched across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 27: gene maps reporting relationships between Reactome pathways enriched across the different contrasts.\n\n\n\n\n\n\n\nThe enriched Reactome pathways are concordant to what emerged so far of the differences and similaritiesof the expression profiles of KIRC, KIRP and KICH kidney carcinomas. KIRC and KIRP have enriched pathwasy related to ion transports and metabolism (e.g.: “SLC-mediated transmembrane transport”, “glycosaminoglycan metabolism”, “biological oxidations”). KIRP has disregulated fatty acid metabolism (“metabolism of steroids”, “synthesis of bile acids and bile salts”), while KIRC has a strong immune engagement (“Costimulation by CD28 family”, “PD-1 signaling”, “Phosphorylation of CD3 and TCR zeta chains”) and extracellular matrix remodelling (“MET promotes cell motility”, “NCAM1 interactions”, “Non-integrin membrane-ECM interactions”)\nThe complete list of 154 Reactome pathways enriched across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n2.4.2.6 WikiPathways\nLastly, also WikiPathways provides another angle on a set of manually curated biological pathways.\n\ndotplotterms mapgene map\n\n\n\n\n\n\n\nFigure 28: dotplot of enriched Wikipathways pathways.\n\n\n\n\n\n\n\n\n\n\n\nFigure 29: Term maps reporting relationships between WikiPathways enriched across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 30: gene maps reporting relationships between WikiPathways enriched across the different contrasts.\n\n\n\n\n\n\n\nThe enriched WikiPathways are consistent with the biological signals captured so far. KIRC and KIRP have enriched metabolism and ion transporters (“Proximal tubule transport”) when compared to KICH. KIRC has a strong signature of immune activation (“Inflammatory response pathway”, “Modulator of TCR signaling and T cell activation”, “T-cell receptor signaling”) and ECM remodelling (“Focal adhesion: PI3K-Akt-mTOR signaling”, “miRNAs targets in ECM and membrane receptors”).\nThe complete list of 154 WikiPathways pathways enriched across the three contrasts is reported below.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transcriptomics Analysis</span>"
    ]
  },
  {
    "objectID": "transcriptomics-analysis.html#infiltrating-immune-cells",
    "href": "transcriptomics-analysis.html#infiltrating-immune-cells",
    "title": "2  Transcriptomics Analysis",
    "section": "2.5 Infiltrating immune cells",
    "text": "2.5 Infiltrating immune cells\nThe Gene Set Enrichment Analyses (Section 2.4.2) revealed that immune response and immune cells infiltration is an emerging biological theme in KIRC when compared to KIRP and KICH kidney carcinomas. While for TCGA we do not have single-cell datasets that would allow for a precise quantification and characterization of the tumor micro-environment, we can get an approximate view of the differences in infiltrating immune cells between the three kidney carcinomas by looking at bulk RNA-seq cellular deconvolution techniques.\nFor this, I will use the R package infiltR, which includes three common bulk RNA-seq deconvolution tools for quantification of tumor-infiltrating immune cells:\n\nCIBERSORT;\nMCP-counter;\nquanTIseq.\n\ninfiltR uses MCP-counter to obtain absolute quantification of infiltrating immune cells, while a more detailed profiling of relative immune cells subtypes is performed with CIBERSORT and quanTIseq.\nLet’s look at the main output of the infiltR predictions:\n\n\n\n\n\nFigure 31: Infiltraing immune cells estimates.\n\n\n\n\nOn the top panel we have the absolute quantification as estimated by MCP-counter, while in the bottom panel we have the relative quantification based on CIBERSORT, MCP-counter and quanTIseq. The emerging picture on the infilatring immune cells is consistent with the enriched pathways we have identified with the GSEA analysis:\n\nKICH: KICH appears like a “cold” tumor, with less infiltrating immune cells, if compared to KIRC and KIRP. Limited immune engagement may limit the number of possible immune-therapeutic targets.\n\nKICH has less absolute number of infiltrating immune cells than KIRC, and similar to KIRP.\nKICH has more T CD4 memory cells and less Tregs fractions than KIRC and KIRP.\nKICH has less Neutrophils, Monocytes and Macrophages fractions than KIRC and KIRP.\n\nKIRC: KIRC appears to have a high amount of infiltrating immune cells. The proportion between CD8 T cells and Tregs may indicate an immune-inflamed but immunosuppressed microenvironment, supported as well by the presence of monocytes and macrophages\n\nKIRC has the highest count of total infiltrating immune cells, and the highest count of CD8 T cells.\nKIRC has the highest fraction of CD8 T cells and Tregs.\nKIRC has the highest fraction of infiltrating monocytes and macrophages M1, and high fraction of Macrophages 2 and Dendritic cells.\n\nKIRP: KIRP appears to have an immature macrophage population in the tumor microenvironment. These M0 macrophages may polarize into either M1 (pro-inflammatory) or M2 (immunosuppressive).\n\nKIRP has an absolute count of infiltrating immune cells comparable to KICH.\nKIRP cell fractions contains the highest Macrophages M0, Macrophages M2 and Dendritic cells resting.\nKIRP cell fraction contains high Tregs.\n\n\nIn Figure 31 we can spot some discrepancies between the predicted infiltrating immune cells proportion across the different methods. infiltR allows as well to compare check the concordance between different estimates, by performing a pairwise aggregation the immune cell types and compare them across couples of methods.\n\n\n\n\n\nFigure 32: Concordance between different estimates.\n\n\n\n\nThe sanity-check plot in Figure 32 reveals that except for the CD8 T cells estimates, the estimates of the three methods have poor correlation. This can be ascribed to the different underlying algorithms for the three different methods, with different assumptions, strengths and weaknesses. Moreover, the overall overlap between cell types detected (more granular for CIBERSORT, more general for MCP-counter) is low, and infiltR aggregation to the minimum-common denominator to perform the comparison may enhance the discrepancy between the methodologies.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transcriptomics Analysis</span>"
    ]
  },
  {
    "objectID": "transcriptomics-analysis.html#sec-lesson-learnt-transcriptomics",
    "href": "transcriptomics-analysis.html#sec-lesson-learnt-transcriptomics",
    "title": "2  Transcriptomics Analysis",
    "section": "2.6 Lessons Learnt",
    "text": "2.6 Lessons Learnt\nBased on transcriptomics data, we have learnt:\n\nExploratory analysis suggests:\n\nKICH clusters with KIRP based on gene expression data.\nLittle to no correlation with vital status or residual disease (follow up tumor status) with kidney carcinoma types.\n\nDifferential Gene Expression analysis:\n\nhere KIRC and KIRP seems more similar to each other (946 DGE genes in common vs KICH).\nKIRC vs KICH enriched in terms associated immune response, T-cell activation, lymphocyte recruitment and stress signaling cascades.\nKIRC seems to have KEGG pathways associated with tumor promoting inflammation, cell proliferation, invasion and metastasis.\n\nTumor-microenvironment characterization:\n\nKICH appears like a “cold” tumor, with less infiltrating immune cells, if compared to KIRC and KIRP.\nKIRC appears to have a high amount of infiltrating immune cells, with an immune-inflamed but immunosuppressed microenvironment.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transcriptomics Analysis</span>"
    ]
  },
  {
    "objectID": "transcriptomics-analysis.html#session-information",
    "href": "transcriptomics-analysis.html#session-information",
    "title": "2  Transcriptomics Analysis",
    "section": "2.7 Session Information",
    "text": "2.7 Session Information\n\n\n\n\n\n\nNote\n\n\n\n\n\n\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-conda-linux-gnu (64-bit)\nRunning under: openSUSE Tumbleweed\n\nMatrix products: default\nBLAS/LAPACK: /home/andrea/miniforge3/envs/moai/lib/libmkl_rt.so.2;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=it_IT.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Brussels\ntzcode source: system (glibc)\n\nattached base packages:\n[1] grid      stats4    stats     graphics  grDevices utils     datasets \n[8] methods   base     \n\nother attached packages:\n [1] UpSetR_1.4.0              umap_0.2.10.0            \n [3] stringr_1.5.1             simplifyEnrichment_1.12.0\n [5] scales_1.3.0              RColorBrewer_1.1-3       \n [7] PCAtools_2.14.0           org.Hs.eg.db_3.18.0      \n [9] matrixStats_1.5.0         infiltR_0.1.0            \n[11] gridExtra_2.3             forcats_1.0.0            \n[13] EnhancedVolcano_1.20.0    ggrepel_0.9.6            \n[15] ggplot2_3.5.1             edgeR_4.0.16             \n[17] limma_3.58.1              DT_0.33                  \n[19] dplyr_1.1.4               DOSE_3.28.2              \n[21] data.table_1.16.4         cowplot_1.1.3            \n[23] clusterProfiler_4.10.1    BiocSingular_1.18.0      \n[25] BiocParallel_1.36.0       AnnotationDbi_1.64.1     \n[27] IRanges_2.36.0            S4Vectors_0.40.2         \n[29] Biobase_2.62.0            BiocGenerics_0.48.1      \n\nloaded via a namespace (and not attached):\n  [1] fs_1.6.5                    bitops_1.0-9               \n  [3] enrichplot_1.22.0           lubridate_1.9.4            \n  [5] HDO.db_0.99.1               httr_1.4.7                 \n  [7] doParallel_1.0.17           tools_4.3.2                \n  [9] backports_1.5.0             R6_2.5.1                   \n [11] mgcv_1.9-1                  lazyeval_0.2.2             \n [13] GetoptLong_1.0.5            withr_3.0.2                \n [15] graphite_1.48.0             preprocessCore_1.64.0      \n [17] quantreg_6.00               cli_3.6.3                  \n [19] scatterpie_0.2.4            labeling_0.4.3             \n [21] slam_0.1-55                 sass_0.4.9                 \n [23] tm_0.7-15                   proxy_0.4-27               \n [25] askpass_1.2.1               yulab.utils_0.2.0          \n [27] gson_0.1.0                  RSQLite_2.3.9              \n [29] RApiSerialize_0.1.4         generics_0.1.3             \n [31] gridGraphics_0.5-1          shape_1.4.6.1              \n [33] crosstalk_1.2.1             car_3.1-3                  \n [35] GO.db_3.18.0                Matrix_1.6-5               \n [37] abind_1.4-8                 lifecycle_1.0.4            \n [39] yaml_2.3.10                 carData_3.0-5              \n [41] ggpmisc_0.6.1               SummarizedExperiment_1.32.0\n [43] MCPcounter_1.2.0            qvalue_2.34.0              \n [45] SparseArray_1.2.4           blob_1.2.4                 \n [47] dqrng_0.4.1                 crayon_1.5.3               \n [49] lattice_0.22-6              beachmat_2.18.1            \n [51] KEGGREST_1.42.0             magick_2.8.5               \n [53] pillar_1.10.1               knitr_1.49                 \n [55] ComplexHeatmap_2.18.0       fgsea_1.28.0               \n [57] GenomicRanges_1.54.1        rjson_0.2.23               \n [59] lpSolve_5.6.23              codetools_0.2-20           \n [61] fastmatch_1.1-6             glue_1.8.0                 \n [63] ggfun_0.1.8                 vctrs_0.6.5                \n [65] png_0.1-8                   treeio_1.26.0              \n [67] gtable_0.3.6                ggpp_0.5.8-1               \n [69] cachem_1.1.0                xfun_0.50                  \n [71] limSolve_1.5.7.1            S4Arrays_1.2.1             \n [73] tidygraph_1.3.1             survival_3.8-3             \n [75] iterators_1.0.14            statmod_1.5.0              \n [77] nlme_3.1-167                ggtree_3.10.1              \n [79] bit64_4.6.0-1               GenomeInfoDb_1.38.8        \n [81] bslib_0.8.0                 irlba_2.3.5.1              \n [83] colorspace_2.1-1            DBI_1.2.3                  \n [85] tidyselect_1.2.1            proxyC_0.4.1               \n [87] bit_4.5.0.1                 compiler_4.3.2             \n [89] graph_1.80.0                SparseM_1.84-2             \n [91] xml2_1.3.6                  NLP_0.3-2                  \n [93] DelayedArray_0.28.0         stringfish_0.16.0          \n [95] shadowtext_0.1.4            quadprog_1.5-8             \n [97] rappdirs_0.3.3              digest_0.6.37              \n [99] rmarkdown_2.29              XVector_0.42.0             \n[101] htmltools_0.5.8.1           pkgconfig_2.0.3            \n[103] sparseMatrixStats_1.14.0    MatrixGenerics_1.14.0      \n[105] fastmap_1.2.0               rlang_1.1.5                \n[107] GlobalOptions_0.1.2         htmlwidgets_1.6.4          \n[109] DelayedMatrixStats_1.24.0   farver_2.1.2               \n[111] jquerylib_0.1.4             jsonlite_1.8.9             \n[113] GOSemSim_2.28.1             RCurl_1.98-1.16            \n[115] magrittr_2.0.3              polynom_1.4-1              \n[117] Formula_1.2-5               GenomeInfoDbData_1.2.11    \n[119] ggplotify_0.1.2             patchwork_1.3.0            \n[121] munsell_0.5.1               Rcpp_1.0.14                \n[123] ape_5.8-1                   ggnewscale_0.5.0           \n[125] viridis_0.6.5               reticulate_1.40.0          \n[127] stringi_1.8.4               ggraph_2.2.1               \n[129] zlibbioc_1.48.2             MASS_7.3-60.0.1            \n[131] plyr_1.8.9                  parallel_4.3.2             \n[133] doSNOW_1.0.20               Biostrings_2.70.3          \n[135] graphlayouts_1.2.2          splines_4.3.2              \n[137] circlize_0.4.16             locfit_1.5-9.10            \n[139] igraph_2.1.4                reshape2_1.4.4             \n[141] ScaledMatrix_1.10.0         evaluate_1.0.3             \n[143] quantiseqr_1.10.0           RcppParallel_5.1.10        \n[145] BiocManager_1.30.25         foreach_1.5.2              \n[147] tweenr_2.0.3                MatrixModels_0.5-3         \n[149] tidyr_1.3.1                 openssl_2.3.1              \n[151] purrr_1.0.2                 polyclip_1.10-7            \n[153] qs_0.27.2                   clue_0.3-66                \n[155] ReactomePA_1.46.0           ggforce_0.4.2              \n[157] rsvd_1.0.5                  broom_1.0.7                \n[159] reactome.db_1.86.2          e1071_1.7-16               \n[161] RSpectra_0.16-2             tidytree_0.4.6             \n[163] rstatix_0.7.2               viridisLite_0.4.2          \n[165] class_7.3-23                snow_0.4-4                 \n[167] tibble_3.2.1                aplot_0.2.4                \n[169] memoise_2.0.1               cluster_2.1.8              \n[171] timechange_0.3.0",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transcriptomics Analysis</span>"
    ]
  },
  {
    "objectID": "proteomics-analysis.html",
    "href": "proteomics-analysis.html",
    "title": "3  Proteomics Analysis",
    "section": "",
    "text": "3.1 On this page\nBiological insights and take-home messages are at the bottom of the page at Lesson Learnt: Section 3.5.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Proteomics Analysis</span>"
    ]
  },
  {
    "objectID": "proteomics-analysis.html#on-this-page",
    "href": "proteomics-analysis.html#on-this-page",
    "title": "3  Proteomics Analysis",
    "section": "",
    "text": "Here we investigate the proteomics data across the three Kidney Cancers.\nFirst, we perform a QC on protein spectra abundance, their distribution across samples and we impute eventual missing values.\nThen, we do some exploratory analyses on samples, gene expression and clinical covariates.\nWe then run a formal Differential Protein Abundance analysis to identify proteins that have different expression levels across the three Kidney cancer types.\nWe perform Gene Set Enrichment Analyses on the differentially abundant proteins to investigate biological and molecular themes that discriminates between the three Kidney cancer types.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Proteomics Analysis</span>"
    ]
  },
  {
    "objectID": "proteomics-analysis.html#proteomics-data-overview-and-qc",
    "href": "proteomics-analysis.html#proteomics-data-overview-and-qc",
    "title": "3  Proteomics Analysis",
    "section": "3.2 Proteomics data overview and QC",
    "text": "3.2 Proteomics data overview and QC\n\n3.2.1 Spectral counts overview\nFor TCGA Kidney cancer proteomics data, we will perform analyses similar to the ones performed for the transcriptomics one (see Chapter 2). We first start with an overview of the datasets and QC.\nLet’s check the spectral counts distributions across samples, and the protein completeness across samples.\n\n\n\n\n\nFigure 1: Proteomics spectral counts missing values.\n\n\n\n\nLooking at the distributions, we can conclude that the spectral intensities were already normalized and scaled, since the spectral values are centered around 0 and have a normal distribution.\nWe have 258 proteins in total, across 709 samples (79.9% of samples had proteomics data).\n\n24 proteins were missing in all samples (100% of patients with proteomics data available)\n1 protein was missing in 440 samples (62.1% of patients with proteomics data available)\n16 proteins were missing in 269 samples (37.9% of patients with proteomics data available)\n6 protein were missing in only 1 sample 211 proteins were detected for all patients with proteomics data available)\n\nWe can obviously drop the 24 proteins for which we have not spectral counts for none of the samples. For the remaining proteins for which we do not have full occupancy, we will apply a standard imputation strategy.\n\n\n3.2.2 Data imputation\nMissing values imputation for label-free proteomics is a large and complex field of study.\nIn our Kidney cancer proteomics samples the number of proteins detected is small and the distribution of missing values is oddly discrete. This suggests that some kind of filtering was already applied during the preprocessing steps, together with scaling and normalization of the proteins spectral counts. The absence can therefore as well be ascribed to biological reasons as well, and not only to technical problems with its detection.\nTo preserve this putative biological signal, I replace in each sample the missing values with the minimum spectral count available in that sample.\nLet’s check how the spectral distributions changed.\n\n\n\n\n\nFigure 2: Proteomics spectral counts after imputation.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Proteomics Analysis</span>"
    ]
  },
  {
    "objectID": "proteomics-analysis.html#dimesionality-reduction-and-dataset-exploration",
    "href": "proteomics-analysis.html#dimesionality-reduction-and-dataset-exploration",
    "title": "3  Proteomics Analysis",
    "section": "3.3 Dimesionality Reduction and Dataset Exploration",
    "text": "3.3 Dimesionality Reduction and Dataset Exploration\n\n3.3.1 UMAP on filtered transcriptomics data\nLet’s check the samples clustering on a UMAP. We have almost a perfect clustering of the samples in their corresponding cancer subtypes, with just 2 KICH samples clusting with KIRC samples.\n\n\n\n\n\nFigure 3: Kidney proteomics UMAP.\n\n\n\n\n\n\n3.3.2 Principal Component Analysis (PCA)\nAs we did for the transcriptomics data (see Chapter 2), the next step in the Dataset exploration is to perform the Principal Component Analysis.\n\n\n\n\n\nFigure 4: PCA, exploration.\n\n\n\n\nThe first 21 Principal Components capture more than 80% of the variance in the Kidney cancers transcriptomics dataset, with the first two components (PC1 and PC2) capturing a bit more than 40% of the variance.\nWhen we project the samples in the PC1 and PC2, we can see that the PC1 separates KIRC from KICH and KIRP, which instead cluster together. The second component PC2, instead, seems to separate KICH and KIRP samples. The separation between KICH and KIRP samples along component PC2 is clearer in the proteomics data than in the transcriptomics data.\n\n\n\n\n\nFigure 5: PCA, biplot PC1 x PC2.\n\n\n\n\n\n\n\n\n\nFigure 6: PCA, pairs plots.\n\n\n\n\nLet’s check the loadings (i.e.: 21 Principal Components capture more than 80% of the variance in the) for the top 4 Principal Components. These indicate which genes are the more responsible to explain the position of the samples along the components, and the direction of this separation.\nLooking at the top 1% most variable proteins (~ 24 proteins), the following 7 proteins are the top loadings for the first 4 Principal Components:\n\nATM\nCLAUDIN7\nEPPK1\nGAPDH\nHSP70\nMYH11\nNDRG1_pT346\n\nLet’s now check the expression of the five top genes identified with the PCA across the cancer types:\n\n\n\n\n\nFigure 7: PCA, loadings.\n\n\n\n\nCLAUDIN-7 is a known diagnostic immunohistochemical marker for classifing chromophobe renal carcinoma (KICH), and indeed seems overexpressed in KICH when compared to KIRC and KIRP.\nLet’s check the Pearson correlation with other clinical covariates.\nHistological grade, subtype mRNA and subtype miRNA strongly correlates with PC1. Cancer type, instead, correlates more with PC2. Interestingly, tumor stage, follow up tumor status and vital status correlates with PC5 (~4% of observed variance), which does not correlates with cancer type but does correlate with subtype protein. This suggest that there is a good correlation between the differences in protein abundances across the kidney carcinomas that correlate with a poorer prognosis, and this signal does not correlate with the kidney carcinoma type (cancer type), nor with the gene expression (subtype mRNA and subtype miRNA).\n\n\n\n\n\nFigure 8: PCA, correlations between clinical covariates and Principal Components.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Proteomics Analysis</span>"
    ]
  },
  {
    "objectID": "proteomics-analysis.html#differential-protein-abundance-analysis",
    "href": "proteomics-analysis.html#differential-protein-abundance-analysis",
    "title": "3  Proteomics Analysis",
    "section": "3.4 Differential protein abundance analysis",
    "text": "3.4 Differential protein abundance analysis\nIn addition to cancer type, we saw that age, ethnicity (and race) and age had somewhat a correlation with the cancer types.\nWe may want to include this covariates in the differential gene expression analysis in order to include their contribution into the model.\n\n3.4.1 Identification of differentially abundant proteins\nFor proteomics analyses, we use two arbitrary thresholds to retain genes that are significantly differentially expressed across the each comparison: an absolute logFold-Change (logFC) higher than 1, and an adjusted p-value lower than 0.05. This results in:\n\nKIRC_vs_KICH, 197 differentially abundant proteins, 105 upregulated and 92 downregulated\nKIRP_vs_KICH, 186 differentially abundant proteins, 97 upregulated and 89 downregulated\nKIRC_vs_KIRP, 207 differentially abundant proteins, 102 upregulated and 105 downregulated\n\nAs usual, we can visualize the logFC p-values relationships for all the proteins with a volcano plot.\n\n\n\n\n\nFigure 9: Volcano plots of each contrats reporting the proteins differentially expressed.\n\n\n\n\nWe can also check the logFC and adjusted p-value for the top 7 proteins that are the top loadings for the first 4 Principal Components and see how these proteins were differentially abundant across the comparisons. We can confirm what we have naively observed at the level of protein abundance in Figure 6 while investigating the PCA loadings: CLAUDIN7 and NDRG1_pT346 are the top loadings for PC1, which separates KIRC from KICH and KIRP, and indeed, these proteins are the most differentially abundant in the comparisons of KIRC versus KIRP or KICH.\n\n\n\n\n\n\nThe UpSet plot shows that KIRC has a strong signature of 19 proteins that are differentially abundant when compared to KIRP or KICH. Moreover, KICH overexpresses c-KIT, ERα_pS118 and CDH1 and downregulates ATM, NDRG1_pT346 and PARP1 when compared to KIRC or KIRP.\n\n\n\n\n\nFigure 10: UpSet reporting the proteins differentially expressed upregulated and downregulated in common across all contrasts.\n\n\n\n\nTables of differentially expressed proteins.\n\nKIRC vs KICHKIRP vs KICHKIRC vs KIRP\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3.4.2 Comparative enrichment analyses across cancer types\nIn the next steps we further characterize the differentially abundant proteins across the three kidney cancers by performing a Gene Set Enrichment Analysis (GSEA).\n\n3.4.2.1 GO Biological Process terms\nGene Ontology Biological Process are the larger processes or ‘biological programs’ accomplished by the concerted action of multiple molecular activities. Examples of broad BP terms are “DNA repair” or “signal transduction”. Examples of more specific terms are “cytosine biosynthetic process” or “D-glucose transmembrane transport”.\n\ndotplotterms mapgene map\n\n\n\n\n\n\n\nFigure 11: dotplot of enriched GO Biological Process terms.\n\n\n\n\n\n\n\n\n\n\n\nFigure 12: Term maps reporting relationships between GO Biological Process across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 13: gene maps reporting relationships between GO Biological Process enriched across the different contrasts.\n\n\n\n\n\n\n\nThe enriched GO BP terms in KIRC vs. KIRP and KIRC vs. KICH suggest that KIRC has a strong enrichment in its catabolic metabolism, with enriched terms such as “carbohydrate catabolic process”, “glycogen catabolic process” and “glycogen metabolic process”. Enrichment of these terms are driven by the overabundance of Glycogen Phosphorylase B, L and M (PYGB, PYGL, PYGM), Lactate Dehydrogenase A (LDHA) and Glyceraldehyde-3-Phosphate Dehydrogenase (GAPDH) in KIRC when compared to KIRP and KICH.\nKICH seems instead to retain more its differentiation as highlighted by the lower abundance of Poly(ADP-Ribose) Polymerase 1 (PARP1) when compared to KIRC and KIRP, resulting in the enrichment of GO BP terms related to “Negative regulation of telomere maintainance”.\nThe complete list of 227 GO BP terms enriched across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n3.4.2.2 GO Cellular Compartments terms\nGene Ontology Cellular Compartment serves to capture the cellular location where a molecular function takes place.\n\ndotplotterms mapgene map\n\n\n\n\n\n\n\nFigure 14: dotplot of enriched GO Cellular Compartments terms.\n\n\n\n\n\n\n\n\n\n\n\nFigure 15: Term maps reporting relationships between GO Cellular Compartments across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 16: gene maps reporting relationships between GO Cellular Compartments enriched across the different contrasts.\n\n\n\n\n\n\n\nGO CC enrichment analyses do not provides any further insights on the characterization of kidney carcinomas based on their proteomics profiles.\nThe complete list of 23 GO CC terms enriched across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n3.4.2.3 GO Molecular Function terms\nGene Ontology Molecular Function serves to represent molecular-level activities performed by gene products.\n\ndotplotterms mapgene map\n\n\n\n\n\n\n\nFigure 17: dotplot of enriched GO Molecular Functions terms.\n\n\n\n\n\n\n\n\n\n\n\nFigure 18: Term maps reporting relationships between GO Molecular Functions across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 19: gene maps reporting relationships between GO Molecular Functions enriched across the different contrasts.\n\n\n\n\n\n\n\nEnrichment of GO MF terms confirm the catabolic signature of KIRC when compared to KIRP and KICH, with enriched terms such as “glycosiltransferase activity” and “pyridoxal phosphate binding” driven by the over abundance of PYGB, PYGL and PYGM.\nThe complete list of 35 GO MF terms enriched across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n3.4.2.4 KEGG pathways\nKEGG pathways are manually curated and capture our knowledge of the molecular interaction, reaction and relation networks.\n\ndotplotterms mapgene map\n\n\n\n\n\n\n\nFigure 20: dotplot of enriched KEGG pathways.\n\n\n\n\n\n\n\n\n\n\n\nFigure 21: Term maps reporting relationships between KEGG pathways enriched across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 22: gene maps reporting relationships between KEGG pathways enriched across the different contrasts.\n\n\n\n\n\n\n\nAlso the enriched KEGG pathways revolved around the metabolic disregulation of KIRC (e.g.: “Glycolysis / Gluconeogenesis” and “Starch and sucrose metabolism”) when compared to KIRP and KICH, linked as well to “Necroptosis” and “HIF-1 signaling pathway”.\nThe complete list of 30 KEGG pathways across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n3.4.2.5 Reactome pathways\nSimilarly to KEGG, Reactome pathways are manually curated biological pathways.\n\ndotplotgene map\n\n\n\n\n\n\n\nFigure 23: dotplot of enriched Reactome pathways.\n\n\n\n\n\n\n\n\n\n\n\nFigure 24: gene maps reporting relationships between Reactome pathways enriched across the different contrasts.\n\n\n\n\n\n\n\nAgain, enriched Reactome pathways characterized KIRC “Glycogen metabolism”, “Metabolosim of charbohydrates” and “Pyruvate metabolism” when compared to KIRP and KICH kidney carcinomas.\nThe complete list of 10 Reactome pathways enriched across the three contrasts is reported below.\n\n\n\n\n\n\n\n\n3.4.2.6 WikiPathways\nLastly, also WikiPathways provides another angle on a set of manually curated biological pathways.\n\ndotplotterms mapgene map\n\n\n\n\n\n\n\nFigure 25: dotplot of enriched Wikipathways pathways.\n\n\n\n\n\n\n\n\n\n\n\nFigure 26: Term maps reporting relationships between WikiPathways enriched across the different contrasts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 27: gene maps reporting relationships between WikiPathways enriched across the different contrasts.\n\n\n\n\n\n\n\nThe enriched WikiPathways confirmed the “Aerobiuc glycolysis - augmented” in KIRC, when compared to KIRP and KIRCH, as well as a proper “Clear cell renal cell carcinoma pathwyas”, driven by the abundance of GAPDH, LDHA and LDHB.\nKICH retention of differentiation was supported by the abundance of the ATM Serine/Threonine Kinase ATM and PARP1, which resulted in the enrichment of terms such as “DNA IR-double strand breaks and cellular response via ATM”.\nThe complete list of 53 WikiPathways pathways enriched across the three contrasts is reported below.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Proteomics Analysis</span>"
    ]
  },
  {
    "objectID": "proteomics-analysis.html#sec-lesson-learnt-proteomics",
    "href": "proteomics-analysis.html#sec-lesson-learnt-proteomics",
    "title": "3  Proteomics Analysis",
    "section": "3.5 Lessons Learnts",
    "text": "3.5 Lessons Learnts\nBased on proteomics data, we have learnt:\n\nExploratory analysis suggests:\n\nKICH clusters with KIRP based on proteomics data.\nThere is a good correlation between the differences in protein abundances across the kidney carcinomas that correlate with a poorer prognosis, and this signal does not correlate with the kidney carcinoma type (cancer type), nor with the gene expression (subtype mRNA and subtype miRNA).\n\nDifferential Gene Expression analysis:\n\nKIRC has a strong signature of 19 proteins.\nKIRC has upregulated glycolysis, glycogen and hypoxia response pathways.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Proteomics Analysis</span>"
    ]
  },
  {
    "objectID": "proteomics-analysis.html#session-information",
    "href": "proteomics-analysis.html#session-information",
    "title": "3  Proteomics Analysis",
    "section": "3.6 Session Information",
    "text": "3.6 Session Information\n\n\n\n\n\n\nNote\n\n\n\n\n\n\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-conda-linux-gnu (64-bit)\nRunning under: openSUSE Tumbleweed\n\nMatrix products: default\nBLAS/LAPACK: /home/andrea/miniforge3/envs/moai/lib/libmkl_rt.so.2;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=it_IT.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Brussels\ntzcode source: system (glibc)\n\nattached base packages:\n[1] grid      stats4    stats     graphics  grDevices utils     datasets \n[8] methods   base     \n\nother attached packages:\n [1] UpSetR_1.4.0           umap_0.2.10.0          stringr_1.5.1         \n [4] scales_1.3.0           RColorBrewer_1.1-3     PCAtools_2.14.0       \n [7] matrixStats_1.5.0      org.Hs.eg.db_3.18.0    gridExtra_2.3         \n[10] forcats_1.0.0          EnhancedVolcano_1.20.0 ggrepel_0.9.6         \n[13] ggplot2_3.5.1          edgeR_4.0.16           limma_3.58.1          \n[16] DT_0.33                dplyr_1.1.4            DOSE_3.28.2           \n[19] data.table_1.16.4      cowplot_1.1.3          clusterProfiler_4.10.1\n[22] BiocSingular_1.18.0    BiocParallel_1.36.0    AnnotationDbi_1.64.1  \n[25] IRanges_2.36.0         S4Vectors_0.40.2       Biobase_2.62.0        \n[28] BiocGenerics_0.48.1   \n\nloaded via a namespace (and not attached):\n  [1] jsonlite_1.8.9            magrittr_2.0.3           \n  [3] farver_2.1.2              rmarkdown_2.29           \n  [5] fs_1.6.5                  zlibbioc_1.48.2          \n  [7] vctrs_0.6.5               DelayedMatrixStats_1.24.0\n  [9] memoise_2.0.1             RCurl_1.98-1.16          \n [11] askpass_1.2.1             ggtree_3.10.1            \n [13] htmltools_0.5.8.1         S4Arrays_1.2.1           \n [15] SparseArray_1.2.4         gridGraphics_0.5-1       \n [17] sass_0.4.9                bslib_0.8.0              \n [19] htmlwidgets_1.6.4         plyr_1.8.9               \n [21] cachem_1.1.0              igraph_2.1.4             \n [23] lifecycle_1.0.4           pkgconfig_2.0.3          \n [25] rsvd_1.0.5                Matrix_1.6-5             \n [27] R6_2.5.1                  fastmap_1.2.0            \n [29] gson_0.1.0                GenomeInfoDbData_1.2.11  \n [31] MatrixGenerics_1.14.0     digest_0.6.37            \n [33] aplot_0.2.4               enrichplot_1.22.0        \n [35] ggnewscale_0.5.0          colorspace_2.1-1         \n [37] patchwork_1.3.0           RSpectra_0.16-2          \n [39] dqrng_0.4.1               irlba_2.3.5.1            \n [41] crosstalk_1.2.1           RSQLite_2.3.9            \n [43] beachmat_2.18.1           labeling_0.4.3           \n [45] httr_1.4.7                polyclip_1.10-7          \n [47] abind_1.4-8               compiler_4.3.2           \n [49] bit64_4.6.0-1             withr_3.0.2              \n [51] graphite_1.48.0           viridis_0.6.5            \n [53] DBI_1.2.3                 ggforce_0.4.2            \n [55] MASS_7.3-60.0.1           openssl_2.3.1            \n [57] rappdirs_0.3.3            DelayedArray_0.28.0      \n [59] HDO.db_0.99.1             tools_4.3.2              \n [61] ape_5.8-1                 scatterpie_0.2.4         \n [63] glue_1.8.0                nlme_3.1-167             \n [65] GOSemSim_2.28.1           shadowtext_0.1.4         \n [67] reshape2_1.4.4            fgsea_1.28.0             \n [69] generics_0.1.3            gtable_0.3.6             \n [71] tidyr_1.3.1               tidygraph_1.3.1          \n [73] ScaledMatrix_1.10.0       XVector_0.42.0           \n [75] pillar_1.10.1             yulab.utils_0.2.0        \n [77] splines_4.3.2             tweenr_2.0.3             \n [79] treeio_1.26.0             lattice_0.22-6           \n [81] bit_4.5.0.1               tidyselect_1.2.1         \n [83] GO.db_3.18.0              locfit_1.5-9.10          \n [85] Biostrings_2.70.3         reactome.db_1.86.2       \n [87] knitr_1.49                xfun_0.50                \n [89] graphlayouts_1.2.2        statmod_1.5.0            \n [91] stringi_1.8.4             lazyeval_0.2.2           \n [93] ggfun_0.1.8               yaml_2.3.10              \n [95] ReactomePA_1.46.0         evaluate_1.0.3           \n [97] codetools_0.2-20          ggraph_2.2.1             \n [99] tibble_3.2.1              qvalue_2.34.0            \n[101] graph_1.80.0              BiocManager_1.30.25      \n[103] ggplotify_0.1.2           cli_3.6.3                \n[105] reticulate_1.40.0         jquerylib_0.1.4          \n[107] munsell_0.5.1             Rcpp_1.0.14              \n[109] GenomeInfoDb_1.38.8       png_0.1-8                \n[111] parallel_4.3.2            blob_1.2.4               \n[113] sparseMatrixStats_1.14.0  bitops_1.0-9             \n[115] viridisLite_0.4.2         tidytree_0.4.6           \n[117] purrr_1.0.2               crayon_1.5.3             \n[119] rlang_1.1.5               fastmatch_1.1-6          \n[121] KEGGREST_1.42.0",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Proteomics Analysis</span>"
    ]
  },
  {
    "objectID": "micro-RNAs-analysis.html",
    "href": "micro-RNAs-analysis.html",
    "title": "4  micro-RNAs Analysis",
    "section": "",
    "text": "4.1 On this page\nBiological insights and take-home messages are at the bottom of the page at Lesson Learnt: Section 2.6.\nFor TCGA Kidney cancer micro RNAs data, we will perform analyses similar to the ones performed for the transcriptomics one (see Chapter 2) and proteomics (see Chapter 2). We first start with an overview of the datasets and QC.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>micro-RNAs Analysis</span>"
    ]
  },
  {
    "objectID": "micro-RNAs-analysis.html#on-this-page",
    "href": "micro-RNAs-analysis.html#on-this-page",
    "title": "4  micro-RNAs Analysis",
    "section": "",
    "text": "Here we investigate the transcriptomics data across the three Kidney Cancers.\nFirst we filter lowly expressed genes and we do some exploratory analyses on samples, gene expression and clinical covariates.\nWe then run a formal Differential Gene Expression analysis to identify genes that have different expression levels across the three Kidney cancer types.\nWe perform Gene Set Enrichment Analyses on the differentially expressed genes to investigate biological and molecular themes that discriminates between the three Kidney cancer types.\nFinally, we characterize the tumour micro-environments of the three Kidney cancer types by quantifying the tumour-infiltrating immune cells.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>micro-RNAs Analysis</span>"
    ]
  },
  {
    "objectID": "micro-RNAs-analysis.html#micro-rnas-data-overview-and-qc",
    "href": "micro-RNAs-analysis.html#micro-rnas-data-overview-and-qc",
    "title": "4  micro-RNAs Analysis",
    "section": "4.2 micro-RNAs data overview and QC",
    "text": "4.2 micro-RNAs data overview and QC\n\n4.2.1 micro-RNAs counts overview\nLet’s check the spectral counts distributions across samples, and the protein completeness across samples.\nWe have 846 samples and 743 micro RNAs\nNo missing values (100% occupancy)\nIt looks like the miRNAs would benefit from a clean up / filtering of lowly expressed miRNAs\nOverabundance of miRNAs with average expression == 0\n\n\n\n\n\nFigure 1: micro-RNAs expression distributions before filtering\n\n\n\n\ndata seems already log2 cpm :(\nnot the best set for filtering by expression\ntable(keep.exprs) keep.exprs FALSE TRUE 553 190\n553 miRNAs are discarded\n\n\n\n\n\nFigure 2: micro-RNAs expression distributions after filtering",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>micro-RNAs Analysis</span>"
    ]
  },
  {
    "objectID": "micro-RNAs-analysis.html#dimesionality-reduction-and-dataset-exploration",
    "href": "micro-RNAs-analysis.html#dimesionality-reduction-and-dataset-exploration",
    "title": "4  micro-RNAs Analysis",
    "section": "4.3 Dimesionality Reduction and Dataset Exploration",
    "text": "4.3 Dimesionality Reduction and Dataset Exploration\n\n4.3.1 UMAP on filtered transcriptomics data\nLet’s check the samples clustering on a UMAP.\nDivision is waaay less clear than the other omics modalities .\n\n\n\n\n\nFigure 3: Kidney proteomics UMAP\n\n\n\n\n\n\n4.3.2 Principal Component Analysis (PCA)\nAs we did for the transcriptomics data (see Chapter 2)., the next step in the Dataset exploration is to perform the Principal Component Analysis.\n\n\n\n\n\nFigure 4: PCA, exploration\n\n\n\n\nThe first 21 Principal Components capture more than 80% of the variance in the Kidney cancers transcriptomics dataset, with the first two components (PC1 and PC2) capturing a bit more than 40% of the variance.\nWhen we project the samples in the PC1 and PC2, we can see that the PC1 separates KIRC from KICH and KIRP, which instead cluster together. The second component PC2, instead, seems to separate KICH and KIRP samples. The separation between KICH and KIRP samples along component PC2 is clearer in the proteomics data than in the transcriptomics data.\n\n\n\n\n\nFigure 5: PCA, biplot PC1 x PC2\n\n\n\n\n\n\n\n\n\nFigure 6: PCA, pairs plots\n\n\n\n\nLet’s check the loadings (i.e.: 21 Principal Components capture more than 80% of the variance in the) for the top 4 Principal Components. These indicate which genes are the more responsible to explain the position of the samples along the components, and the direction of this separation.\n[[[[ADAPT TO PROTEOMICS RESULTS]]]]\nLooking at the top 1% most variable genes (~ 140 genes), the following 5 genes are the top loadings for the first 4 Principal Components:\n\nSPP1\nVIM\nFTL\nRGS5\nLOC96610\n\n[[[[ADAPT TO PROTEOMICS RESULTS]]]]\nLet’s now check the expression of the five top genes identified with the PCA across the cancer types:\n\n\n\n\n\nFigure 6: PCA, loadings\n\n\n\n\nThe miR-200 family as prognostic markers in clear cell renal cell carcinoma\nmir-200c\nhttps://pubmed.ncbi.nlm.nih.gov/31635993/\nLet’s check the Pearson correlation with other clinical covariates.\n[[[[ADAPT TO PROTEOMICS RESULTS]]]]\nCertain histological and molecular subtyping correlates perfectly with PC1 and PC2 (which discriminates KICH) immune infiltrating cells also correlates with PC1 and PC2, and may help to further characterize the subtypes and stratify patients\nAs we have learnt before (Section 1.3.7), KIRC patients seems to had a worse outcome than KIRP and to have tumors in more advanced stages. PC1 (computed from transcriptomics data) clearly separates KIRC and KIRP samples, and it correlates with tumor histological grade and stage, as well as clinical outcome. This show that we have good correlation between clinical observations and gene espression in Kidney cancers.\nsadly, no correlation between the top 5 components and the outcome of therapeutic care.\n[[[[ADAPT TO PROTEOMICS RESULTS]]]]\n\n\n\n\n\nFigure 6: PCA, correlations between clinical covariates and Principal Components",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>micro-RNAs Analysis</span>"
    ]
  },
  {
    "objectID": "micro-RNAs-analysis.html#differential-gene-expression-analysis",
    "href": "micro-RNAs-analysis.html#differential-gene-expression-analysis",
    "title": "4  micro-RNAs Analysis",
    "section": "4.4 Differential gene expression analysis",
    "text": "4.4 Differential gene expression analysis\nIn addition to cancer type, we saw that age, ethnicity (and race) and age had somewhat a correlation with the cancer types.\nWe may want to include this covariates in the differential gene expression analysis in order to include their contribution into the model.\nprint(summary(dt)) KIRC_vs_KICH KIRP_vs_KICH KIRC_vs_KIRP Down 49 68 58 NotSig 23 35 27 Up 118 87 105\n\n4.4.1 Identification of differentially expressed proteins\n\n\n\n\n\nFigure 6: Volcano plots of each contrats reporting the proteins differentially expressed\n\n\n\n\n\n\n\n\n\nFigure 7: UpSet reporting the proteins differentially expressed upregulated and downregulated in common across all contrasts\n\n\n\n\nTables of differentially expressed micro-RNAs\n\nKIRC vs KICHKIRP vs KICHKIRC vs KIRP",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>micro-RNAs Analysis</span>"
    ]
  },
  {
    "objectID": "micro-RNAs-analysis.html#lessons-learnt",
    "href": "micro-RNAs-analysis.html#lessons-learnt",
    "title": "4  micro-RNAs Analysis",
    "section": "4.5 Lessons Learnt",
    "text": "4.5 Lessons Learnt\n[[[[PROPER DESCRIPTION OF FINDINGS AND TRANSCRIPTOMICS ENRICHMENTS]]]]\nSo far, we have learnt:\n\nA",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>micro-RNAs Analysis</span>"
    ]
  },
  {
    "objectID": "genomics-and-epigenomics-analysis.html",
    "href": "genomics-and-epigenomics-analysis.html",
    "title": "5  Genomics and Epigenomics Analysis",
    "section": "",
    "text": "5.1 CNVs\nImport CNVs",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genomics and Epigenomics Analysis</span>"
    ]
  },
  {
    "objectID": "genomics-and-epigenomics-analysis.html#cnvs",
    "href": "genomics-and-epigenomics-analysis.html#cnvs",
    "title": "5  Genomics and Epigenomics Analysis",
    "section": "",
    "text": "5.1.1 Filtering & QC\nCNVs collapsed at the gene level available for 24776 genes\nHow many are all zeros??\nnot a single one with all zeros :/\ncutoff density = 5 because overwelming abundances of 0s\nThere is obviously erinchment in CNVs in KICH when compared to KIRC and KIRP. KIRP has as well an higher number of CNVs than KIRP.\n\n\n\n\n\nFigure 1: CNVs distributions\n\n\n\n\n\n\n5.1.2 CNVs signatures across Kidney cancers\nFollowed guidelines and methodlogies explored by Alexandrov et al., 2022 and Steele et al., 2022\nWe generates novel signatures with SigProfiler\nNeed to reformat as::\nThe CNV signatures you have will be binned based on copy number and segment size. It looks like the data you have is in the format:\nCopy Number&gt;::\nCopy number = The number of alleles in the CNV Label = Name for the copy number event: Homdel = Homozygous deletion. This is CNA=0 LOH = Loss of heterozygousity. One of the parental alleles has been lost. Het = Heterzygous. Both parental alleles are present. Segment size = Size of the CNA segment.\nHope that helps!\nTODO:\n\nadd genomic ranges to genes\nmerge consecutive genes spans with same CNV\nplot them on CIRCOs\n\n\n\n\n\n\nFigure 1: CNVs distributions\n\n\n\n\n\n\n5.1.3 Dimesionality Reduction and Dataset Exploration\n\n5.1.3.1 UMAP on filtered transcriptomics data\nAfter we excluded biopsys from normal tissues and other tumors and we filtered out the lowly expressed genes, the UMAP shows three clusters that are better refined than the ones depicted in Section 1.2.1, and that roughly correspondes with three different kidney cancer subtypes.\n\n\n\n\n\nFigure 2: Kidney UMAP\n\n\n\n\n\n\n5.1.3.2 PCA\n\n\n\n\n\nFigure 3: PCA, exploration\n\n\n\n\nThe first 24 Principal Components capture more than 80% of the variance in the Kidney cancers transcriptomics dataset, with the first two components (PC1 and PC2) capturing a bit more than 25% of the variance.\nWhen we project the samples in the PC1 and PC2, we can see that the PC1 separates KIRC from KICH adn KIRP, which instead cluster together. The second component PC2, instead, seems to partially separate KICH and KIRP samples.\n\n\n\n\n\nFigure 4: PCA, biplot PC1 x PC2\n\n\n\n\nWe can also investigate other dimensions Principal Components, to see if there is a component that manages to fully resove the three cancer types. PC4 seems to separates better the KICH from KIRP, while PC1 can discriminate between KIRC and KIRP.\n\n\n\n\n\nFigure 5: PCA, pairs plots\n\n\n\n\n\n\n\n\n\nFigure 5: PCA, correlations between clinical covariates and Principal Components\n\n\n\n\n\n\n\n5.1.4 CNVs on Factor3 genes\n\n\n\n\n\nFigure 1: CNVs distributions\n\n\n\n\n\n5.1.4.1 Mutational signatures associated to Factor3\n\n\n\n\n\nFigure 1: CNVs distributions",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genomics and Epigenomics Analysis</span>"
    ]
  },
  {
    "objectID": "genomics-and-epigenomics-analysis.html#variants",
    "href": "genomics-and-epigenomics-analysis.html#variants",
    "title": "5  Genomics and Epigenomics Analysis",
    "section": "5.2 Variants",
    "text": "5.2 Variants\nSOMATIC MUTATIONS\n(https://tcga-pancan-atlas-hub.s3.us-east-1.amazonaws.com/download/mc3.v0.2.8.PUBLIC.nonsilentGene.xena.gz)\n711 samples with somatic mutation info available for 40542 genes, 26958 without mutations, 13584 with mutation\n\n\n\n\n\nFigure 1: CNVs distributions\n\n\n\n\n\n5.2.1 Mutational signatures across Kidney cancers\n\n\n\n\n\nFigure 1: CNVs distributions\n\n\n\n\nWHAT IS IN CHROMOSOME 3????????\n\n\nUsing external_gene_name as id variables\n\n\n\n\n\n\n\n\n\n\n5.2.2 Dimesionality Reduction and Dataset Exploration\n\n5.2.2.1 UMAP on filtered transcriptomics data\nAfter we excluded biopsys from normal tissues and other tumors and we filtered out the lowly expressed genes, the UMAP shows three clusters that are better refined than the ones depicted in Section 1.2.1, and that roughly correspondes with three different kidney cancer subtypes.\n\n\n\n\n\nFigure 2: Kidney UMAP\n\n\n\n\n\n\n5.2.2.2 PCA\n\n\n\n\n\nFigure 3: PCA, exploration\n\n\n\n\nThe first 24 Principal Components capture more than 80% of the variance in the Kidney cancers transcriptomics dataset, with the first two components (PC1 and PC2) capturing a bit more than 25% of the variance.\nWhen we project the samples in the PC1 and PC2, we can see that the PC1 separates KIRC from KICH adn KIRP, which instead cluster together. The second component PC2, instead, seems to partially separate KICH and KIRP samples.\nWe can also investigate other dimensions Principal Components, to see if there is a component that manages to fully resove the three cancer types. PC4 seems to separates better the KICH from KIRP, while PC1 can discriminate between KIRC and KIRP.\n\n\n\n\n\nFigure 5: PCA, pairs plots\n\n\n\n\n\n\n\n\n\nFigure 5: PCA, correlations between clinical covariates and Principal Components\n\n\n\n\n\n\n\n5.2.3 Somatic Mutations on Factor3 genes\n\n\n\n\n\nFigure 1: CNVs distributions\n\n\n\n\n\n5.2.3.1 Mutational signatures associated to Factor3\n\n\n\n\n\nFigure 1: CNVs distributions",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genomics and Epigenomics Analysis</span>"
    ]
  },
  {
    "objectID": "genomics-and-epigenomics-analysis.html#epigenomics",
    "href": "genomics-and-epigenomics-analysis.html#epigenomics",
    "title": "5  Genomics and Epigenomics Analysis",
    "section": "5.3 Epigenomics",
    "text": "5.3 Epigenomics\n646 samples with methylation info 148068 whitelisted probes\nRegardless of array type, both the 450k and EPIC record two measurements for each CpG: a methylated intensity (M) and an unmethylated intensity (U). Using these values, the proportion of methylation at each site CpG locus can be determined. The level of methylation at a locus is commonly reported as the Beta-value, i.e. the ratio of the methylated probe intensity and the overall intensity:\nbeta = M/(M/U)\nIllumina recommends adding a constant offset α (by default, α = 100) to the denominator to regularize Beta value when both methylated and unmethylated probe intensities are low. The Beta-value statistic results in a number between 0 and 1, or 0 and 100%. Under ideal conditions, a value of zero indicates that all copies of the CpG site in the sample were completely unmethylated (no methylated molecules were measured) and a value of one indicates that every copy of the site was methylated.\n\n5.3.1 Filtering & QC\nremoved 6364 probes with missing values\n148068-141704 [1] 6364\n\n\n\n\n\nFigure 1: CNVs distributions\n\n\n\n\n\n\n5.3.2 Dimesionality Reduction and Dataset Exploration\n\n5.3.2.1 UMAP on filtered transcriptomics data\nAfter we excluded biopsys from normal tissues and other tumors and we filtered out the lowly expressed genes, the UMAP shows three clusters that are better refined than the ones depicted in Section 1.2.1, and that roughly correspondes with three different kidney cancer subtypes.\n\n\n\n\n\nFigure 2: Kidney UMAP\n\n\n\n\n\n\n5.3.2.2 PCA\n\n\n\n\n\nFigure 3: PCA, exploration\n\n\n\n\nThe first 24 Principal Components capture more than 80% of the variance in the Kidney cancers transcriptomics dataset, with the first two components (PC1 and PC2) capturing a bit more than 25% of the variance.\nWhen we project the samples in the PC1 and PC2, we can see that the PC1 separates KIRC from KICH adn KIRP, which instead cluster together. The second component PC2, instead, seems to partially separate KICH and KIRP samples.\n\n\n\n\n\nFigure 4: PCA, biplot PC1 x PC2\n\n\n\n\nWe can also investigate other dimensions Principal Components, to see if there is a component that manages to fully resove the three cancer types. PC4 seems to separates better the KICH from KIRP, while PC1 can discriminate between KIRC and KIRP.\n\n\n\n\n\nFigure 5: PCA, pairs plots\n\n\n\n\n\n\n\n\n\nFigure 5: PCA, loadings\n\n\n\n\ncg03830585 –&gt; ITPR1 protects renal cancer cells against natural killer cells by inducing autophagy\ncg00868875 –&gt; KCTD1\ncg07037412 –&gt; CACNA1H Voltage-gated calcium channels: Novel targets for cancer therapy CACNA1H was downregulated in gastrointestinal stromal tumor, sarcoma and renal cancer Notably, compared with our previous research, CACNA1H was specifically overexpressed relative to normal tissue samples in renal cancer, sarcoma and gastrointestinal stromal tumors.\n\n\n\n\n\nFigure 5: PCA, correlations between clinical covariates and Principal Components\n\n\n\n\n\n\n\n5.3.3 Probe-Wise Differential Methylation\n\n\n\n\n\nFigure 5: top 3 Differentially Methylated Probes per cancer type\n\n\n\n\nprint(summary(dt)) KIRC_vs_KICH KIRP_vs_KICH KIRC_vs_KIRP Down 56952 43222 69811 NotSig 45814 51748 42083 Up 45302 53098 36174\n\n\n\n\n\nFigure 6: Volcano plots of each contrats reporting the genes differentially expressed\n\n\n\n\n\n\n\n\n\nFigure 7: UpSet reporting the genes differentially methylated probes in common across all contrasts\n\n\n\n\nTables of differentially methylated probes.\n\nKIRC vs KICHKIRP vs KICHKIRC vs KIRP\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nds\n\n5.3.3.1 Functional Enrichments\nLet’s see if any function is enriched in the genes of the Differentially Methilated Probes. Simply extract the methylated probes, compare agains the background ans see if the associated genes are diofferentialy methylated, and see the fucntions / pathways associated with them.\n\nKIRC vs KICHKIRP vs KICHKIRC vs KIRC\n\n\nGO terms\n\n\n\n\n\n\nKEGG pathways\n\n\n\n\n\n\n\n\nGO terms\n\n\n\n\n\n\nKEGG\n\n\n\n\n\n\ns\n\n\nss\ns\n\n\n\n\n\n\ns\ns\n\n\n\n\n\n\ns\n\n\n\ns\nLet’s compare clusters\ns\nd\n\nKEGGReactome\n\n\ns s\n\n\n\n\n\nFigure 17: dotplot of enriched KEGG pathways\n\n\n\n\n\n\n\nFigure 17: dotplot of enriched KEGG pathways\n\n\n\n\n\n\n\nFigure 17: dotplot of enriched KEGG pathways\n\n\n\n\n\n\nx\n\n\n\n\n\nFigure 20: dotplot of enriched Reactome pathways\n\n\n\n\n\n\n\nFigure 20: dotplot of enriched Reactome pathways\n\n\n\n\n\n\n\nFigure 20: dotplot of enriched Reactome pathways\n\n\n\n\ns\n\n\n\nx ssss\ns\n\n\n5.3.3.2 Aaggreagte probes into functional regions\nOften, differential methylation of a single CpG is not so informative or can be hard to detect. Therefore, knowing whether several CpGs near to each other (or regions) are concordantly differentially methylated can be of greater interest.\nThere are several Bioconductor packages that have functions for identifying differentially methylated regions from 450k data. Some of the most popular are the dmrFind function in the charm package, which has been somewhat superseded for 450k arrays by the bumphunter function in minfi, and, the dmrcate in the DMRcate package. They are each based on different statistical methods, but we will be using dmrcate here, as it is based on limma and thus we can use the design and contrast matrix we defined earlier.\nWe will again start from our matrix of M-values. For this kind of analysis, this matrix has to be annotated with the chromosomal position of the CpGs and their gene annotations. Because in a first step the limma differential methylation analysis for single CpGs will be run again, we need to specify the design matrix, contrast matrix and contrast of interest.\nOnce we have the relevant statistics for the individual CpGs, we can then use the dmrcate function to combine them to identify differentially methylated regions. Of particular interest here is the lambda parameter; this value is the number of nucleotides that is allowed between significant CpGs before splitting them up in different regions. So a smaller lambda will result in more but smaller regions. For array data, the authors of the dmrcate package currently recommend a lambda of 1000. The main output table DMRs contains all of the regions found, along with their genomic annotations and p-values. To inspect this object and further visualization, you can best use the extractRanges function to create a GRanges object.\nDifferentially Methylated regions\nKIRC_vs_KICH: 20346 KIRP_vs_KICH: 19243 KIRC_vs_KIRP: 20773\nJust as for the single CpG analysis, it is a good idea to visually inspect the results to make sure they make sense. For this, use the DMR.plot function. By default, this plot draws the location of the DMR in the genome, the position of nearby genes, the positions of the CpG probes, the Beta value levels of each sample as a heatmap and the mean methylation levels for the various sample groups in the experiment.\n\n\n5.3.3.3 Functional Regions mCSEA\nAn alternative approach to detect DMRs is to predefine the regions to be tested; so, as opposed to the previous approach where the regions are defined according to heuristic distance rules we can define regions based on a shared function. For this, we will used the package mCSEA which contains three types of regions for 450K and EPIC arrays: promoter regions, gene body and CpG Islands. mCSEA is based on Gene Set Enrichment analysis (GSEA), a popular methodology for functional analysis that was specifically designed to avoid some drawbacks in the field of gene expression. Briefly, CpG sites are ranked according to a metric (logFC, t-statistic, …) and an enrichment score (ES) is calculated for each region. This is done by running through the entire ranked CpG list, increasing the score when a CpG in the region is encountered and decreasing the score when the gene encountered is not in the region. A high ES indicates these probes are found high up in the ranked list. In other words, a high (N)ES value means that for the CpG sites in this region there is - on average - a shift towards a higher methylation level. This approach has been shown to be more effective to detect smaller but consistent methylation differences.\n\nKIRC vs KICHKIRP vs KICHKIRC vs KIRP\n\n\npromoters\n\n\n\n\n\n\ngenes\n\n\n\n\n\n\n85promoters, 150 genes\n\n\n74 promoters 0 genes\npromoters\n\n\n\n\n\n\ngenes\n\n\n\n\n\n\n\n\n172 promoters, 50 genes\npromoters\n\n\n\n\n\n\ngenes\n\n\n\n\n\n\n\n\n\ncc\n\n5.3.3.3.1 mCSEA Functional Enrichments\nLet’s see if any function is enriched in the genes of the Differentially Methilated Probes. Simply extract the methylated probes, compare agains the background ans see if the associated genes are diofferentialy methylated, and see the fucntions / pathways associated with them.\nd\n\nGO MFKEGGReactomeWikiPathways\n\n\n\n\n\n\n\nFigure 8: dotplot of enriched GO Biological Process terms\n\n\n\n\n\n\n\nFigure 8: dotplot of enriched GO Biological Process terms\n\n\n\n\n\n\n\nFigure 8: dotplot of enriched GO Biological Process terms\n\n\n\n\n\n\n\n\n\n\n\nFigure 17: dotplot of enriched KEGG pathways\n\n\n\n\n\n\n\nFigure 17: dotplot of enriched KEGG pathways\n\n\n\n\n\n\n\n\n\n\n\nFigure 20: dotplot of enriched Reactome pathways\n\n\n\n\n\n\n\nFigure 20: dotplot of enriched Reactome pathways\n\n\n\n\n\n\n\n\n\n\n\nFigure 20: dotplot of enriched Wikipathways pathways\n\n\n\n\n\n\n\nc",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genomics and Epigenomics Analysis</span>"
    ]
  },
  {
    "objectID": "genomics-and-epigenomics-analysis.html#lessons-learnt",
    "href": "genomics-and-epigenomics-analysis.html#lessons-learnt",
    "title": "5  Genomics and Epigenomics Analysis",
    "section": "5.4 Lessons Learnt",
    "text": "5.4 Lessons Learnt\n[[[[PROPER DESCRIPTION OF FINDINGS AND TRANSCRIPTOMICS ENRICHMENTS]]]]\nSo far, we have learnt:\n\nA",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genomics and Epigenomics Analysis</span>"
    ]
  },
  {
    "objectID": "factor-analysis.html",
    "href": "factor-analysis.html",
    "title": "6  Factor Analysis",
    "section": "",
    "text": "6.1 On this page\nBiological insights and take-home messages are at the bottom of the page at section Lesson Learnt: Section 6.3.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Factor Analysis</span>"
    ]
  },
  {
    "objectID": "factor-analysis.html#on-this-page",
    "href": "factor-analysis.html#on-this-page",
    "title": "6  Factor Analysis",
    "section": "",
    "text": "Here…",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Factor Analysis</span>"
    ]
  },
  {
    "objectID": "factor-analysis.html#multi-omics-factor-analysis",
    "href": "factor-analysis.html#multi-omics-factor-analysis",
    "title": "6  Factor Analysis",
    "section": "6.2 Multi-Omics Factor Analysis",
    "text": "6.2 Multi-Omics Factor Analysis\n\n6.2.1 data prep\nHere we leverage and integrate all the omics layers that we have analysed independently in the previous chapters, including:\n\ntranscriptomics\nestimated infiltrating immune cells\nproteomics\nmicro-RNAs\nCopy Number Variants\n\nDespite the preprocessing, to compare this multiomics readouts on different scales we need to rescale and normalize each table\nmay want to ignore this one\n\n\n\n\n\nFigure 1: Multiomics data overview\n\n\n\n\n\n\n6.2.2 run prediction\nmodel prediction outcomes\n\n\n\n\n\nFigure 2: Multiomics data overview\n\n\n\n\n\n\n\n\n\nFigure 2:\n\n\n\n\n\n\n\nFigure 2:\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n6.2.3 Factor 1: KIRC vs KIRP\n\nmRNAmicro-RNAproteomicsmethyl\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\ndd\n\n6.2.3.1 Multi-omics interaction network\nGET top molecules\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\nGather OmniPath and STRINGdb\nOmniPath can serve multiple kinds of interactions, based on the quality of the interactors or the interactions themselves:\n\npost_translational i.e. physical interactions of proteins, protein-protein interactions (or PPIs)\ntranscriptional i.e. gene regulatory interactions\npost_transcriptional i.e. miRNA-mRNA interactions\nmirna_transcriptional i.e. transcriptional regulation of miRNA genes\n\nLIST ALL INTERACTIONS\nget_intercell_resources()\n##  [1] \"Adhesome\"             \"Almen2009\"            \"Baccin2019\"          \n##  [4] \"CellCellInteractions\" \"CellPhoneDB\"          \"ComPPI\"              \n##  [7] \"CSPA\"                 \"DGIdb\"                \"EMBRACE\"             \n## [10] \"GO_Intercell\"         \"GPCRdb\"               \"Guide2Pharma\"        \n## [13] \"HGNC\"                 \"HPA_secretome\"        \"HPMR\"                \n## [16] \"ICELLNET\"             \"Integrins\"            \"iTALK\"               \n## [19] \"Kirouac2010\"          \"LOCATE\"               \"LRdb\"                \n## [22] \"Matrisome\"            \"MatrixDB\"             \"MCAM\"                \n## [25] \"Membranome\"           \"OmniPath\"             \"OPM\"                 \n## [28] \"Phobius\"              \"Ramilowski_location\"  \"Ramilowski2015\"      \n## [31] \"SignaLink_function\"   \"Surfaceome\"           \"TopDB\"               \n## [34] \"UniProt_keyword\"      \"UniProt_location\"     \"UniProt_topology\"    \n## [37] \"Zhong2015\"\nLet’s build the network now\nplot my network\n\n\n\n\n\nFigure 99: KIRC vs KIRP model\n\n\n\n\n\n\n\nFigure 99: KIRC vs KIRP model\n\n\n\n\nLet’s build a wider network\nMUST FIND A WAY TO SIMPLIFY NETWORK IF NO INTERACTION BETWEEN SIGNIFICANT IN MORE THAN 1 STEP\n\n\n6.2.3.2 Pathway analysis\nprep gene list\nLittle GO relevant terms\nSome KEGG pathways, with very low gene coverage (false positive)\nsome Reactome pathways, but with low coverage (max 10% of genes covered)\nThe network we have built may reflect new interactions.\n\n\n\n\n\nFigure 8: dotplot of enriched GO Biological Process terms\n\n\n\n\nWikipathways\n\n\n\n\n\nFigure 8: dotplot of enriched GO Biological Process terms\n\n\n\n\n\n\n\n6.2.4 Factor 2: KICH\n\nmRNAmicro-RNAproteomicsmethyl\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\ndaadadad\n\n6.2.4.1 Multi-omics interaction network\nGET top molecules\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\nLet’s build the network now\nplot my network\n\n\n\n\n\nFigure 99: KICH model\n\n\n\n\n\n\n\nFigure 99: KICH model\n\n\n\n\nss\n\n\n6.2.4.2 Pathway analysis\nprep gene list\nSome relevant biological processes\n\n\n\n\n\nFigure 8: dotplot of enriched GO Biological Process terms\n\n\n\n\nNo KEGG pathways\nNo reactome (generatio &lt;= 10%)\n\n\n\n\n\nFigure 8: dotplot of over-represented Reactome pathways\n\n\n\n\nWikipathways\n\n\n\n\n\nFigure 8: dotplot of enriched GO Biological Process terms\n\n\n\n\nsaassaas\n\n\n\n6.2.5 Factor 3: Higher Hazard Ratio\n\nmRNAmicro-RNAproteomicsmethyl\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\n\n\n\ndaadadad\n\n6.2.5.1 Multi-omics interaction network\nGET top molecules\n\n\n\n\n\nFigure 1: Filtering Lowly Expressed Genes\n\n\n\n\nLet’s build the network now\nplot my network\n\n\n\n\n\nFigure 99: KICH model\n\n\n\n\n\n\n\nFigure 99: KICH model\n\n\n\n\nss\n\n\n6.2.5.2 Pathway analysis\nprep gene list\nSome relevant biological processes\nNo KEGG pathways\nNo reactome (generatio &lt;= 10%)\n\n\n\n\n\nFigure 8: dotplot of over-represented Reactome pathways\n\n\n\n\nWikipathways\n\n\n\n\n\nFigure 8: dotplot of enriched GO Biological Process terms\n\n\n\n\nwuwuwuwuwuwuwuwwuwuwuwuwuwuwu\n\n\n\n6.2.6 Enrichments comparisons\nlets compare the KIRC vs KIRP and KICH gene lists\nprep gene lists\n\nGO BPGO CCGO MFKEGG pathwaysReactome pathwaysWikiPathways\n\n\n\n\n\n\n\nFigure 9: Term maps reporting relationships between GO Biological Process across the different contrasts\n\n\n\n\n\n\n\n\n\n\n\nFigure 11: dotplot of enriched GO Cellular Compartments terms\n\n\n\n\n\n\n\n\n\n\n\nFigure 14: dotplot of enriched GO Molecular Functions terms\n\n\n\n\n\n\n\n\n\n\n\nFigure 17: dotplot of enriched KEGG pathways\n\n\n\n\n\n\n\n\n\n\n\nFigure 20: dotplot of enriched Reactome pathways\n\n\n\n\n\n\n\n\n\n\n\nFigure 20: dotplot of enriched WikiPathways",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Factor Analysis</span>"
    ]
  },
  {
    "objectID": "factor-analysis.html#sec-lesson-learnt-factor-analysis",
    "href": "factor-analysis.html#sec-lesson-learnt-factor-analysis",
    "title": "6  Factor Analysis",
    "section": "6.3 Lessons Learnt",
    "text": "6.3 Lessons Learnt\n[[[[PROPER DESCRIPTION OF FINDINGS AND TRANSCRIPTOMICS ENRICHMENTS]]]]\nSo far, we have learnt:\n\nA",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Factor Analysis</span>"
    ]
  },
  {
    "objectID": "survival-analysis.html",
    "href": "survival-analysis.html",
    "title": "7  Survival Analysis",
    "section": "",
    "text": "7.1 On this page\nBiological insights and take-home messages are at the bottom of the page at section Lesson Learnt: Section 7.4.",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Survival Analysis</span>"
    ]
  },
  {
    "objectID": "survival-analysis.html#on-this-page",
    "href": "survival-analysis.html#on-this-page",
    "title": "7  Survival Analysis",
    "section": "",
    "text": "Here…",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Survival Analysis</span>"
    ]
  },
  {
    "objectID": "survival-analysis.html#survival-analysis-overall-survival",
    "href": "survival-analysis.html#survival-analysis-overall-survival",
    "title": "7  Survival Analysis",
    "section": "7.2 Survival Analysis: Overall Survival",
    "text": "7.2 Survival Analysis: Overall Survival\nIntro\nLoad data\nwe have these timepoints:\n\noverall survival (OS)\ndisease-specific survival (DSS)\ndisease-free interval (DFI)\nprogression-free interval (PFI)\n\nto that, we add info:\n\nvital status\ndays to death\ncancer type\n\nwe will measure a Kaplan Meier curve and fit a Cox Proportional Hazards Model for each kidney cancer subtype only based on the observations and classification available in the metadata. Then, we will add the weights for Factors 1, 2 and 3 that we have calculated with the Factor Analysis (Chapter 6) on the integrated multi-omics datasets (transcriptomics, miRNAs, proteomics and epigenomics). We compare the results and we see if adding info from the multi-omics lead to a model that predicts better the clinical outcome.\n\n7.2.1 Metadata only\nlet’s do it with metadat aonly first\n\n7.2.1.1 Kaplan Meier\nplot the survival\n\n\n\n\n\nFigure 1: survival\n\n\n\n\ncompare survival plots\nlog rank test\nCall: survival::survdiff(formula = survival::Surv(OS.time, vital_status) ~ cancer_type, data = metadata)\nn=885, 2 observations deleted due to missingness.\n                    N Observed Expected (O-E)^2/E (O-E)^2/V\ncancer_type=TCGA-KICH 65 9 26.0 11.14 12.87 cancer_type=TCGA-KIRC 531 174 140.4 8.04 21.18 cancer_type=TCGA-KIRP 289 44 60.6 4.54 6.26\nChisq= 23.9 on 2 degrees of freedom, p= 6e-06\nAs noted on this page the term (O-E)^2/V is the basis for the log-rank test.\nTo know if the difference between the observed and expected events (O-E) for one group is significantly different from 0 (that is, the two groups have significantly different hazard functions), you need an estimate of the variance of that difference in the case (null hypothesis) that the groups have the same hazard function.\n\n\n\n\n\n\n\n\n7.2.1.2 Cox regression model\nCox proportional hazards regression is one of the most popular regression techniques for survival analysis. Other models can also be used since the Cox model requires important assumptions that need to be verified for an appropriate use such as the proportional hazards assumption: see references.\nIn a Cox proportional hazards regression model, the measure of effect is the hazard rate (HR), which is the risk of failure (or the risk of death in our example), given that the participant has survived up to a specific time. Usually, we are interested in comparing independent groups with respect to their hazards, and we use a hazard ratio, which is analogous to an odds ratio in the setting of multiple logistic regression analysis. The cox.ph() function from the survival package is used to fit the model. The function cox.zph() from survival package may be used to test the proportional hazards assumption for a Cox regression model fit.\nNOTE: A probability must lie in the range 0 to 1. However, the hazard represents the expected number of events per one unit of time.\n\nIf the hazard ratio for a predictor is close to 1 then that predictor does not affect survival,\nif the HR is less than 1, then the predictor is protective (i.e., associated with improved survival),\nand if the HR is greater than 1, then the predictor is associated with increased risk (or decreased survival).\n\n[[[now we can add more covariates, but we have to check if the proportional hazard assumption holds true]]]\nIn another model we add more risk factors such as the source of infection and the number of days between date of onset and admission. This time, we first verify the proportional hazards assumption before going forward.\nIn this model, we have included a continuous predictor (days_onset_hosp). In this case we interpret the parameter estimates as the increase in the expected log of the relative hazard for each one unit increase in the predictor, holding other predictors constant. We first verify the proportional hazards assumption.\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\nlet’s add more covariates into the model\n\nDemographic covariatesTumor grading covariatesMolecular subtype covariatesDemographic + Tumor grading + Molecular Subtype covariates\n\n\nWE GET INFINITE COEFFICIEMT WITH RACE\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\nTumor stage “tumor_stage” Tumor histological grade “histological_grade” TMN main tumor pathology “pathologic_t” TMN lymph nodes metastatis “pathologic”\nprint chi squared tab\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\nsubtype_miRNA “Subtype_miRNA”, subtype_mRNA “Subtype_mRNA”, Subtype_selected “Subtype_Selected” Subtype_Immune_Model_Based\nprint chi squared tab\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\n\nsssss\n\n\n7.2.1.3 more modeling\nwe could model Tumor STage. other stages molecular subtypes &lt;– here we can improve on them later with more fancy classifications\nSex “gdc_cases.demographic.gender_1_1” Disease status “cgc_follow_up_tumor_status_1_1” Tumor stage “cgc_case_pathologic_stage_1_1” Tumor histological grade “histological_grade” TMN main tumor pathology “cgc_case_pathologic_t_1_1” TMN lymph nodes metastatis “cgc_case_pathologic_n_1_1”\n\nTumor Status\n\n\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\n\n\n\n\n7.2.2 Multi-omics predictive model for clinical outcome\nsssss\ncox_fit\nLikelihood ratio test=171.1 on 10 df, p=&lt; 2.2e-16 n= 885, number of events= 227 (2 observations deleted due to missingness)\n\n\n\n\n\n\nPlot Hazard-Ratio\n\n\n\n\n\nFigure 1: Plot hazard ratio\n\n\n\n\nPlot Kaplan-Meier\n\n\n\n\n\nFigure 1: Plot hazard ratio",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Survival Analysis</span>"
    ]
  },
  {
    "objectID": "survival-analysis.html#survival-analysis-progression-free-interval-pfi",
    "href": "survival-analysis.html#survival-analysis-progression-free-interval-pfi",
    "title": "7  Survival Analysis",
    "section": "7.3 Survival Analysis: Progression-Free Interval (PFI)",
    "text": "7.3 Survival Analysis: Progression-Free Interval (PFI)\n\n7.3.1 Metadata only - progression-free interval (PFI)\nlet’s do it with metadat aonly first\n\n7.3.1.1 Kaplan Meier\nplot the survival\n\n\n\n\n\nFigure 1: survival\n\n\n\n\ncompare survival plots\nlog rank test\nCall: survival::survdiff(formula = survival::Surv(OS.time, vital_status) ~ cancer_type, data = metadata)\nn=885, 2 observations deleted due to missingness.\n                    N Observed Expected (O-E)^2/E (O-E)^2/V\ncancer_type=TCGA-KICH 65 9 26.0 11.14 12.87 cancer_type=TCGA-KIRC 531 174 140.4 8.04 21.18 cancer_type=TCGA-KIRP 289 44 60.6 4.54 6.26\nChisq= 23.9 on 2 degrees of freedom, p= 6e-06\nAs noted on this page the term (O-E)^2/V is the basis for the log-rank test.\nTo know if the difference between the observed and expected events (O-E) for one group is significantly different from 0 (that is, the two groups have significantly different hazard functions), you need an estimate of the variance of that difference in the case (null hypothesis) that the groups have the same hazard function.\n\n\n\n\n\n\n\n\n7.3.1.2 Cox regression model\nCox proportional hazards regression is one of the most popular regression techniques for survival analysis. Other models can also be used since the Cox model requires important assumptions that need to be verified for an appropriate use such as the proportional hazards assumption: see references.\nIn a Cox proportional hazards regression model, the measure of effect is the hazard rate (HR), which is the risk of failure (or the risk of death in our example), given that the participant has survived up to a specific time. Usually, we are interested in comparing independent groups with respect to their hazards, and we use a hazard ratio, which is analogous to an odds ratio in the setting of multiple logistic regression analysis. The cox.ph() function from the survival package is used to fit the model. The function cox.zph() from survival package may be used to test the proportional hazards assumption for a Cox regression model fit.\nNOTE: A probability must lie in the range 0 to 1. However, the hazard represents the expected number of events per one unit of time.\n\nIf the hazard ratio for a predictor is close to 1 then that predictor does not affect survival,\nif the HR is less than 1, then the predictor is protective (i.e., associated with improved survival),\nand if the HR is greater than 1, then the predictor is associated with increased risk (or decreased survival).\n\n[[[now we can add more covariates, but we have to check if the proportional hazard assumption holds true]]]\nIn another model we add more risk factors such as the source of infection and the number of days between date of onset and admission. This time, we first verify the proportional hazards assumption before going forward.\nIn this model, we have included a continuous predictor (days_onset_hosp). In this case we interpret the parameter estimates as the increase in the expected log of the relative hazard for each one unit increase in the predictor, holding other predictors constant. We first verify the proportional hazards assumption.\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\nlet’s add more covariates into the model\n\nDemographic covariatesTumor grading covariatesMolecular subtype covariatesDemographic + Tumor grading + Molecular Subtype covariates\n\n\nWE GET INFINITE COEFFICIEMT WITH RACE\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\nTumor stage “tumor_stage” Tumor histological grade “histological_grade” TMN main tumor pathology “pathologic_t” TMN lymph nodes metastatis “pathologic”\nprint chi squared tab\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\nsubtype_miRNA “Subtype_miRNA”, subtype_mRNA “Subtype_mRNA”, Subtype_selected “Subtype_Selected” Subtype_Immune_Model_Based\nprint chi squared tab\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\n\n\n\n\n\n\nForest plot\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\n\nsssss\n\n\n7.3.1.3 more modeling\nwe could model Tumor STage. other stages molecular subtypes &lt;– here we can improve on them later with more fancy classifications\nSex “gdc_cases.demographic.gender_1_1” Disease status “cgc_follow_up_tumor_status_1_1” Tumor stage “cgc_case_pathologic_stage_1_1” Tumor histological grade “histological_grade” TMN main tumor pathology “cgc_case_pathologic_t_1_1” TMN lymph nodes metastatis “cgc_case_pathologic_n_1_1”\n\nTumor Status\n\n\n\n\n\n\n\nFigure 1: survival\n\n\n\n\n\n\n\n\n\n\n7.3.2 Multi-omics predictive model for clinical outcome\nsssss\ncox_fit\nLikelihood ratio test=171.1 on 10 df, p=&lt; 2.2e-16 n= 885, number of events= 227 (2 observations deleted due to missingness)\n\n\n\n\n\n\nPlot Hazard-Ratio\n\n\n\n\n\nFigure 1: Plot hazard ratio\n\n\n\n\nPlot Kaplan-Meier\n\n\n\n\n\nFigure 1: Plot hazard ratio",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Survival Analysis</span>"
    ]
  },
  {
    "objectID": "survival-analysis.html#sec-lesson-learnt-survival-analysis",
    "href": "survival-analysis.html#sec-lesson-learnt-survival-analysis",
    "title": "7  Survival Analysis",
    "section": "7.4 Lessons Learnt",
    "text": "7.4 Lessons Learnt\n[[[[PROPER DESCRIPTION OF FINDINGS AND TRANSCRIPTOMICS ENRICHMENTS]]]]\nSo far, we have learnt:\n\nA",
    "crumbs": [
      "Characterization of Kidney Clear Cell, Papillary Cell and Chromophobe cancers",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Survival Analysis</span>"
    ]
  },
  {
    "objectID": "cellular-deconvolution.html",
    "href": "cellular-deconvolution.html",
    "title": "11  Cellular Deconvolution from Bulk RNA-seq",
    "section": "",
    "text": "11.0.0.1 MOFA unsupervised & multiomics\nd",
    "crumbs": [
      "Characterization of Kidney Clear Cell Cancer molecular subtypes",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Cellular Deconvolution from Bulk RNA-seq</span>"
    ]
  },
  {
    "objectID": "cellular-deconvolution.html#characterization-of-cancer-molecular-subtype",
    "href": "cellular-deconvolution.html#characterization-of-cancer-molecular-subtype",
    "title": "11  Cellular Deconvolution from Bulk RNA-seq",
    "section": "11.1 Characterization of Cancer Molecular Subtype",
    "text": "11.1 Characterization of Cancer Molecular Subtype\nd",
    "crumbs": [
      "Characterization of Kidney Clear Cell Cancer molecular subtypes",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Cellular Deconvolution from Bulk RNA-seq</span>"
    ]
  }
]